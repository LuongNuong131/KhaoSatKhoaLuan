<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Kh·∫£o S√°t - L√†ng Hoa Sa ƒê√©c | IUH Tourism Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        position: relative;
        overflow-x: hidden;
      }
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
            circle at 20% 50%,
            rgba(102, 126, 234, 0.4) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(118, 75, 162, 0.4) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 20%,
            rgba(240, 147, 251, 0.3) 0%,
            transparent 40%
          );
        animation: gradientShift 20s ease infinite;
        pointer-events: none;
        z-index: 0;
      }
      @keyframes gradientShift {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.8;
          transform: scale(1.1);
        }
      }
      .glassmorphism {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }
      .card-hover {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      .card-hover::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        transition: left 0.5s;
      }
      .card-hover:hover::before {
        left: 100%;
      }
      .card-hover:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      }
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fadeInUp {
        animation: fadeInUp 0.6s ease-out forwards;
      }
      .section-title {
        position: relative;
        display: inline-block;
      }
      .section-title::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 0;
        width: 60px;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2);
        border-radius: 2px;
        animation: expandWidth 0.6s ease-out;
      }
      @keyframes expandWidth {
        from {
          width: 0;
        }
        to {
          width: 60px;
        }
      }
      .nav-btn {
        padding: 12px 24px;
        margin: 0 8px;
        border-radius: 12px;
        font-weight: 600;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        cursor: pointer;
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
      }
      .nav-btn::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
      }
      .nav-btn:hover::before {
        width: 300px;
        height: 300px;
      }
      .nav-btn.active {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:not(.active) {
        background: rgba(255, 255, 255, 0.25);
        color: black;
        backdrop-filter: blur(10px);
      }
      .nav-btn:not(.active):hover {
        background: rgba(255, 255, 255, 0.4);
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      }
      .section-content {
        display: none;
        animation: fadeInContent 0.5s ease-out;
      }
      @keyframes fadeInContent {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .section-content.active {
        display: block;
      }
      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        position: relative;
        overflow: hidden;
      }
      .stat-card::after {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: rotate 20s linear infinite;
      }
      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }
      .stat-card p:first-child {
        color: rgba(255, 255, 255, 0.8);
      }
      .chart-wrapper {
        position: relative;
        height: 350px;
      }
      .chart-wrapper-large {
        position: relative;
        height: 500px;
      }
      @media (max-width: 768px) {
        .chart-wrapper {
          height: 280px;
        }
        .chart-wrapper-large {
          height: 400px;
        }
      }
      .progress-bar {
        background: #e5e7eb;
        border-radius: 9999px;
        height: 10px;
        overflow: hidden;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .progress-fill {
        background: linear-gradient(90deg, #667eea, #764ba2);
        height: 100%;
        transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
      }
      .max-w-7xl {
        position: relative;
        z-index: 1;
      }
      .logo-section {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        margin-bottom: 20px;
      }
      .logo-container {
        width: 80px;
        height: 80px;
        background: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
      }
      .logo-container:hover {
        transform: scale(1.1) rotate(5deg);
      }
      .logo-container svg {
        width: 50px;
        height: 50px;
      }
      .project-badge {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 8px 20px;
        border-radius: 20px;
        font-size: 13px;
        font-weight: 600;
        display: inline-block;
        margin-top: 10px;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
      }
      .info-box {
        background: linear-gradient(135deg, #f093fb, #f5576c);
        color: white;
        padding: 20px;
        border-radius: 16px;
        margin-bottom: 20px;
        box-shadow: 0 8px 24px rgba(240, 147, 251, 0.3);
      }
      .info-box h3 {
        font-size: 18px;
        font-weight: 700;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .info-box p {
        font-size: 14px;
        line-height: 1.6;
        opacity: 0.95;
      }
      .export-btn {
        background: linear-gradient(135deg, #43e97b, #38f9d7);
        color: black;
        padding: 12px 24px;
        border-radius: 12px;
        font-weight: 600;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        cursor: pointer;
        transition: all 0.3s;
        border: none;
        box-shadow: 0 4px 12px rgba(67, 233, 123, 0.4);
      }
      .export-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(67, 233, 123, 0.6);
      }
      .metric-card {
        background: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        border-left: 5px solid #667eea;
        transition: all 0.3s;
      }
      .metric-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
      }
      .metric-label {
        font-size: 13px;
        color: #6b7280;
        font-weight: 600;
        margin-bottom: 10px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }
      .metric-value {
        font-size: 32px;
        font-weight: 800;
        color: #1f2937;
        line-height: 1;
      }
      .highlight-box {
        background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
        padding: 20px;
        border-radius: 16px;
        margin: 10px 0;
        box-shadow: 0 4px 12px rgba(253, 203, 110, 0.3);
      }
      .highlight-box p {
        color: #2d3436;
        font-weight: 600;
        margin: 0;
      }
      .stat-number {
        font-size: 3.5rem;
        font-weight: 900;
        line-height: 1;
        text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.15);
      }
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 9999;
        transition: opacity 0.5s;
      }
      .loading-spinner {
        width: 60px;
        height: 60px;
        border: 5px solid rgba(255, 255, 255, 0.2);
        border-top-color: white;
        border-radius: 50%;
        animation: spin 0.8s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .insight-card {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
        margin-bottom: 16px;
        transition: all 0.3s;
      }
      .insight-card:hover {
        transform: translateX(8px);
        box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5);
      }
      .insight-card h4 {
        font-size: 17px;
        font-weight: 700;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .insight-card p {
        font-size: 14px;
        line-height: 1.7;
        opacity: 0.95;
      }
      .top-item {
        transition: all 0.3s;
        padding: 8px;
        border-radius: 8px;
      }
      .top-item:hover {
        background: rgba(102, 126, 234, 0.05);
        transform: translateX(4px);
      }
      .feedback-card {
        transition: all 0.3s;
      }
      .feedback-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);
      }
      .scroll-to-top {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 50px;
        height: 50px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s;
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        z-index: 1000;
      }
      .scroll-to-top.visible {
        opacity: 1;
        visibility: visible;
      }
      .scroll-to-top:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
      }

      /* Th√™m style cho th√¥ng b√°o export */
      @keyframes slideIn {
        from {
          transform: translateX(400px);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      @keyframes slideOut {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(400px);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body class="min-h-screen p-4 md:p-8">
    <div id="loadingOverlay" class="loading-overlay">
      <div class="text-center">
        <div class="loading-spinner mx-auto mb-4"></div>
        <p class="text-white text-xl font-bold">ƒêang t·∫£i d·ªØ li·ªáu kh·∫£o s√°t...</p>
        <p class="text-white/80 text-sm mt-2">Vui l√≤ng ch·ªù trong gi√¢y l√°t</p>
      </div>
    </div>

    <div id="scrollToTop" class="scroll-to-top" onclick="scrollToTop()">
      <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
        <path
          fill-rule="evenodd"
          d="M8 15a.5.5 0 0 0 .5-.5V2.707l3.146 3.147a.5.5 0 0 0 .708-.708l-4-4a.5.5 0 0 0-.708 0l-4 4a.5.5 0 1 0 .708.708L7.5 2.707V14.5a.5.5 0 0 0 .5.5z"
        />
      </svg>
    </div>

    <div class="max-w-7xl mx-auto">
      <header
        class="glassmorphism rounded-2xl p-8 mb-8 shadow-2xl animate-fadeInUp"
      >
        <div class="text-center">
          <div class="logo-section">
            <div class="logo-container">
              <svg viewBox="0 0 100 100" fill="none">
                <rect
                  x="10"
                  y="10"
                  width="80"
                  height="80"
                  rx="10"
                  fill="#667eea"
                />
                <text
                  x="50"
                  y="65"
                  font-size="40"
                  font-weight="bold"
                  fill="white"
                  text-anchor="middle"
                >
                  IUH
                </text>
              </svg>
            </div>

            <div class="logo-container">
              <svg viewBox="0 0 100 100" fill="none">
                <circle cx="50" cy="50" r="40" fill="#f093fb" />
                <path d="M50 30 L40 50 L50 45 L60 50 Z" fill="white" />
                <circle cx="50" cy="55" r="8" fill="white" />
                <rect x="47" y="60" width="6" height="20" fill="#38f9d7" />
              </svg>
            </div>
          </div>

          <h1
            class="text-4xl md:text-5xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-3"
          >
            Dashboard Ph√¢n T√≠ch Kh·∫£o S√°t
          </h1>
          <p class="text-gray-800 font-semibold text-xl mb-2">
            Ph√°t tri·ªÉn s·∫£n ph·∫©m du l·ªãch n√¥ng nghi·ªáp tr·∫£i nghi·ªám
          </p>
          <p class="text-gray-700 font-medium text-lg mb-3">
            üå∏ L√†ng hoa Sa ƒê√©c, t·ªânh ƒê·ªìng Th√°p üå∏
          </p>

          <div class="project-badge">
            Kh√≥a lu·∫≠n t·ªët nghi·ªáp - Khoa Th∆∞∆°ng m·∫°i - Du l·ªãch
          </div>
          <p class="text-sm text-gray-600 mt-2">
            Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng Nghi·ªáp TP.HCM | Kh√≥a 18 - Qu·∫£n tr·ªã d·ªãch v·ª• du
            l·ªãch v√† l·ªØ h√†nh
          </p>

          <div class="mt-6">
            <button class="export-btn" onclick="exportSummary()">
              <svg
                width="20"
                height="20"
                fill="currentColor"
                viewBox="0 0 16 16"
              >
                <path
                  d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"
                />
                <path
                  d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"
                />
              </svg>
              Xu·∫•t B√°o C√°o T√≥m T·∫Øt
            </button>
          </div>
        </div>
      </header>

      <div class="info-box animate-fadeInUp" style="animation-delay: 0.1s">
        <h3>
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
            <path
              d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"
            />
          </svg>
          V·ªÅ Kh·∫£o S√°t N√†y
        </h3>
        <p>
          Kh·∫£o s√°t n√†y nh·∫±m thu th·∫≠p √Ω ki·∫øn c·ªßa du kh√°ch v·ªÅ m·ª©c ƒë·ªô h√†i l√≤ng v√†
          nhu c·∫ßu ph√°t tri·ªÉn c√°c s·∫£n ph·∫©m du l·ªãch n√¥ng nghi·ªáp tr·∫£i nghi·ªám t·∫°i
          L√†ng hoa Sa ƒê√©c. Nh·ªØng √Ω ki·∫øn ƒë√≥ng g√≥p qu√Ω b√°u t·ª´ du kh√°ch l√† c∆° s·ªü
          quan tr·ªçng ƒë·ªÉ ƒë·ªÅ xu·∫•t c√°c gi·∫£i ph√°p ph√°t tri·ªÉn s·∫£n ph·∫©m du l·ªãch m·ªõi,
          h·∫•p d·∫´n v√† b·ªÅn v·ªØng h∆°n.
        </p>
      </div>

      <div
        class="glassmorphism rounded-2xl p-6 mb-8 shadow-xl animate-fadeInUp"
        style="animation-delay: 0.2s"
      >
        <div class="flex flex-wrap justify-center gap-3">
          <button
            class="nav-btn active"
            onclick="showSection('overview', this)"
          >
            üìä T·ªïng quan
          </button>
          <button class="nav-btn" onclick="showSection('demographics', this)">
            üë• Nh√¢n kh·∫©u h·ªçc
          </button>
          <button class="nav-btn" onclick="showSection('behavior', this)">
            üéØ H√†nh vi du l·ªãch
          </button>
          <button class="nav-btn" onclick="showSection('satisfaction', this)">
            ‚≠ê M·ª©c ƒë·ªô h√†i l√≤ng
          </button>
          <button class="nav-btn" onclick="showSection('experience', this)">
            üå± Tr·∫£i nghi·ªám n√¥ng nghi·ªáp
          </button>
          <button class="nav-btn" onclick="showSection('future', this)">
            üöÄ D·ª± ƒë·ªãnh t∆∞∆°ng lai
          </button>
          <button class="nav-btn" onclick="showSection('feedback', this)">
            üí¨ Ph·∫£n h·ªìi & ƒê·ªÅ xu·∫•t
          </button>
        </div>
      </div>

      <div id="overview-section" class="section-content active">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          <div class="stat-card rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-white/80 text-sm font-medium mb-2">T·ªïng ph·∫£n h·ªìi</p>
            <p id="totalResponses" class="stat-number">0</p>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-gray-600 text-sm font-medium mb-2">
              Nh√≥m tu·ªïi ph·ªï bi·∫øn
            </p>
            <p
              id="popularAgeGroup"
              class="stat-number text-gray-800"
              style="font-size: 2.5rem"
            >
              N/A
            </p>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-gray-600 text-sm font-medium mb-2">
              ƒêi·ªÉm h√†i l√≤ng TB
            </p>
            <div
              id="satisfactionRate"
              class="text-3xl font-bold text-purple-600"
            >
              <span title="ƒêi·ªÉm trung b√¨nh">0.00</span>
              <span class="text-xl text-gray-500" title="ƒê·ªô l·ªách chu·∫©n"
                >(s=0.00)</span
              >
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-gray-600 text-sm font-medium mb-2">
              S·∫µn s√†ng quay l·∫°i
            </p>
            <p id="returnRate" class="stat-number text-blue-600">0%</p>
          </div>
        </div>

        <div class="glassmorphism rounded-2xl p-6 shadow-xl mb-6">
          <h3 class="section-title text-2xl font-bold mb-6">
            üìà Ph√¢n T√≠ch Insights T·ª± ƒê·ªông
          </h3>
          <div id="keyInsights" class="space-y-4 mb-6"></div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
            <div class="metric-card">
              <div class="metric-label">Quan t√¢m tr·∫£i nghi·ªám n√¥ng nghi·ªáp</div>
              <div class="metric-value" id="expInterestPercent">0%</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">S·∫µn s√†ng gi·ªõi thi·ªáu b·∫°n b√®</div>
              <div class="metric-value" id="referralPercent">0%</div>
            </div>
            <div class="metric-card">
              <div class="metric-label">M·ª©c gi√° ch·∫•p nh·∫≠n (trung b√¨nh)</div>
              <div class="metric-value" id="avgPrice">N/A</div>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              üèÜ Top 5 Ngh·ªÅ nghi·ªáp
            </h3>
            <div id="topOccupations" class="space-y-3"></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">üìç Top 5 N∆°i ·ªü</h3>
            <div id="topLocations" class="space-y-3"></div>
          </div>
        </div>
      </div>

      <div id="demographics-section" class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <h3 class="section-title text-xl font-bold mb-6">Gi·ªõi t√≠nh</h3>
            <div class="chart-wrapper"><canvas id="genderChart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <h3 class="section-title text-xl font-bold mb-6">ƒê·ªô tu·ªïi</h3>
            <div class="chart-wrapper"><canvas id="ageChart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <h3 class="section-title text-xl font-bold mb-6">Ngh·ªÅ nghi·ªáp</h3>
            <div class="chart-wrapper">
              <canvas id="occupationChart"></canvas>
            </div>
          </div>
          <div
            class="glassmorphism rounded-2xl p-6 shadow-xl card-hover lg:col-span-2 xl:col-span-3"
          >
            <h3 class="section-title text-xl font-bold mb-6">N∆°i ·ªü hi·ªán t·∫°i</h3>
            <div class="chart-wrapper-large">
              <canvas id="locationChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div id="behavior-section" class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              S·ªë l·∫ßn ƒë·∫øn Sa ƒê√©c
            </h3>
            <div class="chart-wrapper">
              <canvas id="visitFrequencyChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">ƒêi c√πng ai?</h3>
            <div class="chart-wrapper">
              <canvas id="companionChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              H√¨nh th·ª©c du l·ªãch
            </h3>
            <div class="chart-wrapper">
              <canvas id="travelTypeChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Th·ªùi gian l∆∞u tr√∫
            </h3>
            <div class="chart-wrapper">
              <canvas id="stayDurationChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2">
            <h3 class="section-title text-xl font-bold mb-6">
              K√™nh bi·∫øt ƒë·∫øn L√†ng hoa
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="sourceChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2">
            <h3 class="section-title text-xl font-bold mb-6">
              M·ª•c ƒë√≠ch chuy·∫øn ƒëi
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="purposeChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2">
            <h3 class="section-title text-xl font-bold mb-6">
              Ho·∫°t ƒë·ªông ƒë√£ tham gia
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="activitiesChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div id="satisfaction-section" class="section-content">
        <div class="highlight-box mb-6">
          <p>
            üìä ƒê√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ 11 y·∫øu t·ªë t·∫°i L√†ng hoa Sa ƒê√©c (Mean &
            ƒê·ªô l·ªách chu·∫©n)
          </p>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">S·ª± phong ph√∫ lo·∫°i hoa</h3>
              <div>
                <span
                  id="sat1Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat1StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat1Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">S·ª± hi·∫øu kh√°ch</h3>
              <div>
                <span
                  id="sat2Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat2StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat2Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">C·∫£nh quan & v·ªá sinh</h3>
              <div>
                <span
                  id="sat3Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat3StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat3Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">Th√°i ƒë·ªô nh√¢n vi√™n</h3>
              <div>
                <span
                  id="sat4Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat4StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat4Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">C∆° s·ªü h·∫° t·∫ßng</h3>
              <div>
                <span
                  id="sat5Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat5StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat5Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">N√©t ƒë·ªôc ƒë√°o</h3>
              <div>
                <span
                  id="sat6Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat6StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat6Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">Ch·∫•t l∆∞·ª£ng d·ªãch v·ª•</h3>
              <div>
                <span
                  id="sat7Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat7StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat7Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">Gi√° c·∫£ d·ªãch v·ª•</h3>
              <div>
                <span
                  id="sat8Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat8StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat8Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">S·ª± an to√†n</h3>
              <div>
                <span
                  id="sat9Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat9StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat9Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">ƒêa d·∫°ng ho·∫°t ƒë·ªông</h3>
              <div>
                <span
                  id="sat10Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat10StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat10Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <div class="flex justify-between items-center mb-4">
              <h3 class="text-lg font-bold">T√≠nh k·∫øt n·ªëi tour</h3>
              <div>
                <span
                  id="sat11Mean"
                  class="text-2xl font-bold text-purple-600"
                  title="ƒêi·ªÉm trung b√¨nh"
                  >0.00</span
                >
                <span
                  id="sat11StdDev"
                  class="text-lg font-medium text-gray-500"
                  title="ƒê·ªô l·ªách chu·∫©n"
                  >(s=0.00)</span
                >
              </div>
            </div>
            <div class="chart-wrapper"><canvas id="sat11Chart"></canvas></div>
          </div>
        </div>
      </div>

      <div id="experience-section" class="section-content">
        <div class="highlight-box mb-6">
          <p>
            üå± Nhu c·∫ßu v√† k·ª≥ v·ªçng v·ªÅ ph√°t tri·ªÉn du l·ªãch n√¥ng nghi·ªáp tr·∫£i nghi·ªám
          </p>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Quan t√¢m tr·∫£i nghi·ªám n√¥ng nghi·ªáp? (C√¢u 13)
            </h3>
            <div class="chart-wrapper">
              <canvas id="expInterestChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              M·ª©c chi tr·∫£ mong mu·ªën (C√¢u 15)
            </h3>
            <div class="chart-wrapper">
              <canvas id="priceRangeChart"></canvas>
            </div>
          </div>

          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              üìä ƒêi·ªÉm quan t√¢m TB (C√¢u 14)
            </h3>
            <div
              id="interestMeanList"
              class="space-y-3 max-h-[300px] overflow-y-auto pr-2"
            ></div>
          </div>

          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Y·∫øu t·ªë thu h√∫t tham gia (C√¢u 16)
            </h3>
            <div class="chart-wrapper-large" style="height: 400px">
              <canvas id="attractionFactorsChart"></canvas>
            </div>
          </div>

          <div class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2">
            <h3 class="section-title text-xl font-bold mb-6">
              Y·∫øu t·ªë c·∫ßn c·∫£i thi·ªán (C√¢u 17)
            </h3>
            <div class="chart-wrapper-large" style="height: 400px">
              <canvas id="improvementChart"></canvas>
            </div>
          </div>

          <div
            class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2 mt-6"
          >
            <h3 class="section-title text-xl font-bold mb-6">
              Chi ti·∫øt M·ª©c ƒë·ªô Quan t√¢m (C√¢u 14)
            </h3>
            <div
              class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 mt-12"
            >
              <div class="glassmorphism rounded-2xl p-4 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                  <h3 class="text-md font-bold">Tour xe ƒë·∫°p/xe ƒëi·ªán</h3>
                  <div>
                    <span
                      id="int1Mean"
                      class="text-xl font-bold text-purple-600"
                      title="ƒêi·ªÉm trung b√¨nh"
                      >0.00</span
                    >
                    <span
                      id="int1StdDev"
                      class="text-md font-medium text-gray-500"
                      title="ƒê·ªô l·ªách chu·∫©n"
                      >(s=0.00)</span
                    >
                  </div>
                </div>
                <div class="chart-wrapper" style="height: 250px">
                  <canvas id="int1Chart"></canvas>
                </div>
              </div>
              <div class="glassmorphism rounded-2xl p-4 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                  <h3 class="text-md font-bold">"M·ªôt ng√†y l√†m n√¥ng d√¢n"</h3>
                  <div>
                    <span
                      id="int2Mean"
                      class="text-xl font-bold text-purple-600"
                      title="ƒêi·ªÉm trung b√¨nh"
                      >0.00</span
                    >
                    <span
                      id="int2StdDev"
                      class="text-md font-medium text-gray-500"
                      title="ƒê·ªô l·ªách chu·∫©n"
                      >(s=0.00)</span
                    >
                  </div>
                </div>
                <div class="chart-wrapper" style="height: 250px">
                  <canvas id="int2Chart"></canvas>
                </div>
              </div>
              <div class="glassmorphism rounded-2xl p-4 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                  <h3 class="text-md font-bold">Workshop c·∫Øm hoa/bonsai</h3>
                  <div>
                    <span
                      id="int3Mean"
                      class="text-xl font-bold text-purple-600"
                      title="ƒêi·ªÉm trung b√¨nh"
                      >0.00</span
                    >
                    <span
                      id="int3StdDev"
                      class="text-md font-medium text-gray-500"
                      title="ƒê·ªô l·ªách chu·∫©n"
                      >(s=0.00)</span
                    >
                  </div>
                </div>
                <div class="chart-wrapper" style="height: 250px">
                  <canvas id="int3Chart"></canvas>
                </div>
              </div>
              <div class="glassmorphism rounded-2xl p-4 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                  <h3 class="text-md font-bold">L·ªõp h·ªçc n·∫•u ƒÉn/l√†m b√°nh</h3>
                  <div>
                    <span
                      id="int4Mean"
                      class="text-xl font-bold text-purple-600"
                      title="ƒêi·ªÉm trung b√¨nh"
                      >0.00</span
                    >
                    <span
                      id="int4StdDev"
                      class="text-md font-medium text-gray-500"
                      title="ƒê·ªô l·ªách chu·∫©n"
                      >(s=0.00)</span
                    >
                  </div>
                </div>
                <div class="chart-wrapper" style="height: 250px">
                  <canvas id="int4Chart"></canvas>
                </div>
              </div>
              <div class="glassmorphism rounded-2xl p-4 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                  <h3 class="text-md font-bold">
                    Workshop th·ªß c√¥ng (n·∫øn, tr√†)
                  </h3>
                  <div>
                    <span
                      id="int5Mean"
                      class="text-xl font-bold text-purple-600"
                      title="ƒêi·ªÉm trung b√¨nh"
                      >0.00</span
                    >
                    <span
                      id="int5StdDev"
                      class="text-md font-medium text-gray-500"
                      title="ƒê·ªô l·ªách chu·∫©n"
                      >(s=0.00)</span
                    >
                  </div>
                </div>
                <div class="chart-wrapper" style="height: 250px">
                  <canvas id="int5Chart"></canvas>
                </div>
              </div>
              <div class="glassmorphism rounded-2xl p-4 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                  <h3 class="text-md font-bold">Ho·∫°t ƒë·ªông s√¥ng n∆∞·ªõc</h3>
                  <div>
                    <span
                      id="int6Mean"
                      class="text-xl font-bold text-purple-600"
                      title="ƒêi·ªÉm trung b√¨nh"
                      >0.00</span
                    >
                    <span
                      id="int6StdDev"
                      class="text-md font-medium text-gray-500"
                      title="ƒê·ªô l·ªách chu·∫©n"
                      >(s=0.00)</span
                    >
                  </div>
                </div>
                <div class="chart-wrapper" style="height: 250px">
                  <canvas id="int6Chart"></canvas>
                </div>
              </div>
              <div class="glassmorphism rounded-2xl p-4 shadow-lg">
                <div class="flex justify-between items-center mb-4">
                  <h3 class="text-md font-bold">L∆∞u tr√∫ Homestay</h3>
                  <div>
                    <span
                      id="int7Mean"
                      class="text-xl font-bold text-purple-600"
                      title="ƒêi·ªÉm trung b√¨nh"
                      >0.00</span
                    >
                    <span
                      id="int7StdDev"
                      class="text-md font-medium text-gray-500"
                      title="ƒê·ªô l·ªách chu·∫©n"
                      >(s=0.00)</span
                    >
                  </div>
                </div>
                <div class="chart-wrapper" style="height: 250px">
                  <canvas id="int7Chart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="future-section" class="section-content">
        <div class="highlight-box mb-6">
          <p>üöÄ D·ª± ƒë·ªãnh v√† cam k·∫øt c·ªßa du kh√°ch v·ªõi L√†ng hoa Sa ƒê√©c</p>
        </div>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Gi·ªõi thi·ªáu b·∫°n b√®? (C√¢u 18)
            </h3>
            <div class="chart-wrapper">
              <canvas id="referralChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              D·ª± ƒë·ªãnh quay l·∫°i? (C√¢u 19)
            </h3>
            <div class="chart-wrapper"><canvas id="returnChart"></canvas></div>
          </div>
        </div>
      </div>

      <div id="feedback-section" class="section-content">
        <div class="highlight-box mb-6">
          <p>üí¨ C·∫£m nh·∫≠n th·ª±c t·∫ø v√† ƒë·ªÅ xu·∫•t ph√°t tri·ªÉn t·ª´ du kh√°ch</p>
        </div>
        <div class="grid grid-cols-1 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Danh s√°ch C·∫£m nh·∫≠n (C√¢u 20) & ƒê·ªÅ xu·∫•t (C√¢u 21)
            </h3>
            <div
              id="feedbackListBox"
              class="space-y-4 max-h-[600px] overflow-y-auto pr-2"
            ></div>
          </div>
        </div>
      </div>

      <footer class="mt-8 glassmorphism rounded-2xl p-6 text-center shadow-xl">
        <p class="text-gray-700 font-semibold mb-2">
          ¬© 2025 Kh√≥a lu·∫≠n t·ªët nghi·ªáp - Khoa Th∆∞∆°ng m·∫°i - Du l·ªãch
        </p>
        <p class="text-gray-600 text-sm mb-2">
          Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng Nghi·ªáp Th√†nh ph·ªë H·ªì Ch√≠ Minh
        </p>
        <p class="text-gray-500 text-xs">
          Dashboard ph√°t tri·ªÉn b·ªüi nh√≥m sinh vi√™n Kh√≥a 18 - Qu·∫£n tr·ªã d·ªãch v·ª• du
          l·ªãch v√† l·ªØ h√†nh
        </p>
      </footer>
    </div>

    <script>
      // ===================================================================
      // PH·∫¶N 1: N·∫†P V√Ä X·ª¨ L√ù D·ªÆ LI·ªÜU
      // ===================================================================
      const charts = {};
      const colors = [
        "#667eea",
        "#764ba2",
        "#f093fb",
        "#4facfe",
        "#43e97b",
        "#fa709a",
        "#fee140",
        "#30cfd0",
        "#a8edea",
        "#fed6e3",
      ];
      let globalData = [];
      let columnMapping = {};

      const scoreMap = {
        "r·∫•t kh√¥ng h√†i l√≤ng": 1,
        "kh√¥ng h√†i l√≤ng": 2,
        "b√¨nh th∆∞·ªùng": 3,
        "h√†i l√≤ng": 4,
        "r·∫•t h√†i l√≤ng": 5,
        "ho√†n to√†n kh√¥ng quan t√¢m": 1,
        "kh√¥ng quan t√¢m": 2,
        "quan t√¢m": 4,
        "r·∫•t quan t√¢m": 5,
        1: 1,
        2: 2,
        3: 3,
        4: 4,
        5: 5,
      };

      // Scroll to top functionality
      window.addEventListener("scroll", function () {
        const scrollBtn = document.getElementById("scrollToTop");
        if (window.pageYOffset > 300) {
          scrollBtn.classList.add("visible");
        } else {
          scrollBtn.classList.remove("visible");
        }
      });

      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      document.addEventListener("DOMContentLoaded", loadData);

      async function loadData() {
        const loadingOverlay = document.getElementById("loadingOverlay");

        try {
          console.log("ƒêang t·∫£i d·ªØ li·ªáu t·ª´ data.json...");
          const response = await fetch("data.json");

          if (!response.ok) {
            throw new Error(
              `HTTP error! status: ${response.status}. Kh√¥ng t√¨m th·∫•y file data.json?`
            );
          }

          const rawData = await response.json();
          console.log("D·ªØ li·ªáu th√¥:", rawData);

          if (Array.isArray(rawData)) {
            console.log("‚úì ƒê·ªãnh d·∫°ng: Array");
            console.log("S·ªë d√≤ng:", rawData.length);

            if (rawData.length < 2) {
              throw new Error(
                "File data.json kh√¥ng c√≥ d·ªØ li·ªáu (ch·ªâ c√≥ header)!"
              );
            }

            columnMapping = rawData[0];
            console.log("Column mapping:", columnMapping);

            globalData = rawData
              .slice(1)
              .map((row) => {
                const newRow = {};
                for (const key in row) {
                  if (columnMapping[key]) {
                    newRow[columnMapping[key]] = row[key];
                  }
                }
                return newRow;
              })
              .filter((row) =>
                Object.values(row).some(
                  (v) => v !== "" && v !== null && v !== undefined
                )
              );
          } else {
            throw new Error("ƒê·ªãnh d·∫°ng data.json kh√¥ng h·ª£p l·ªá!");
          }

          console.log("D·ªØ li·ªáu ƒë√£ x·ª≠ l√Ω:", globalData);
          console.log("S·ªë b·∫£n ghi h·ª£p l·ªá:", globalData.length);

          if (globalData.length === 0) {
            throw new Error(
              "‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu! Vui l√≤ng ki·ªÉm tra l·∫°i file data.json"
            );
          }

          processAllData();
          console.log("‚úÖ T·∫£i d·ªØ li·ªáu th√†nh c√¥ng!");

          setTimeout(() => {
            loadingOverlay.style.opacity = "0";
            setTimeout(() => {
              loadingOverlay.style.display = "none";
            }, 500);
          }, 800);
        } catch (error) {
          console.error("‚ùå L·ªói chi ti·∫øt:", error);
          loadingOverlay.innerHTML = `
                <div class="text-center px-6">
                  <div class="text-6xl mb-4">‚ö†Ô∏è</div>
                  <p class="text-white text-xl font-bold mb-2">Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu!</p>
                  <p class="text-white/80 text-sm mb-4">${error.message}</p>
                  <p class="text-white/60 text-xs">H√£y ƒë·∫£m b·∫£o file 'data.json' n·∫±m c√πng th∆∞ m·ª•c v·ªõi file HTML n√†y.</p>
                  <button onclick="location.reload()" class="mt-6 px-6 py-3 bg-white text-purple-600 rounded-lg font-semibold hover:bg-gray-100 transition">
                    üîÑ Th·ª≠ l·∫°i
                  </button>
                </div>
              `;
        }
      }

      function smartSplitAnswers(text) {
        if (!text) return [];
        const parts = text.split(",");
        const results = [];
        let currentAnswer = "";

        for (let i = 0; i < parts.length; i++) {
          const part = parts[i].trim();
          if (!part) continue;
          if (currentAnswer === "") {
            currentAnswer = part;
          } else {
            const firstChar = part.charAt(0);
            const isUpperCase =
              firstChar === firstChar.toUpperCase() &&
              firstChar !== firstChar.toLowerCase();
            if (isUpperCase && part.length > 3) {
              results.push(currentAnswer);
              currentAnswer = part;
            } else {
              currentAnswer += ", " + part;
            }
          }
        }
        if (currentAnswer) {
          results.push(currentAnswer);
        }
        return results.filter((item) => item && item.length > 0);
      }

      // ===================================================================
      // PH·∫¶N 2: C√ÅC H√ÄM T√çNH TO√ÅN (MEAN V√Ä ƒê·ªò L·ªÜCH CHU·∫®N)
      // ===================================================================

      /**
       * FIX: Th√™m h√†m helper quan tr·ªçng n√†y
       * H√†m n√†y l·∫•y t√™n c·ªôt th·ª±c t·∫ø (v√≠ d·ª•: "1. Gi·ªõi t√≠nh:") t·ª´ ch·ªØ c√°i (v√≠ d·ª•: "B")
       */
      function getColumnByLetter(letter) {
        if (Object.keys(columnMapping).length === 0) {
          console.error("Column mapping ch∆∞a ƒë∆∞·ª£c t·∫£i!");
          return null;
        }
        const colName = columnMapping[letter];
        if (!colName) {
          console.warn(`Kh√¥ng t√¨m th·∫•y mapping cho ch·ªØ c√°i: ${letter}`);
          return null;
        }
        return colName;
      }

      function getMeanScore(data, colName) {
        let totalScore = 0;
        let count = 0;
        if (!colName) return 0;
        data.forEach((row) => {
          const val = String(row[colName] || "")
            .trim()
            .toLowerCase();
          const score = scoreMap[val];
          if (score) {
            totalScore += score;
            count++;
          }
        });
        return count > 0 ? totalScore / count : 0;
      }

      function getStandardDeviation(data, colName, mean) {
        if (!colName || mean === 0) return 0;

        let sumOfSquaredDeviations = 0;
        let n = 0;

        data.forEach((row) => {
          const val = String(row[colName] || "")
            .trim()
            .toLowerCase();
          const score = scoreMap[val];
          if (score) {
            const deviation = score - mean;
            sumOfSquaredDeviations += deviation * deviation;
            n++;
          }
        });

        if (n <= 1) return 0;

        const variance = sumOfSquaredDeviations / (n - 1);
        return Math.sqrt(variance);
      }

      // ===================================================================
      // PH·∫¶N 3: H√ÄM PH√ÇN T√çCH INSIGHTS T·ª∞ ƒê·ªòNG (ƒê√É S·ª¨A L·ªñI)
      // ===================================================================

      /**
       * FIX:
       * 1. ƒê√£ x√≥a 'parseFloat' v√¨ 'returnRate', 'expRate', 'refRate' ƒë√£ l√† S·ªê (number).
       * 2. ƒê√£ th√™m '.toFixed(1) + "%"' v√†o ph·∫ßn text ƒë·ªÉ hi·ªÉn th·ªã ƒë·∫πp.
       */
      function generateInsights(
        data,
        satisfactionMean,
        returnRate,
        expRate,
        refRate
      ) {
        const insights = [];

        if (satisfactionMean >= 4.0) {
          insights.push({
            icon: "üåü",
            title: "M·ª©c ƒë·ªô h√†i l√≤ng xu·∫•t s·∫Øc",
            text: `V·ªõi ƒëi·ªÉm trung b√¨nh ${satisfactionMean.toFixed(
              2
            )}/5.0, du kh√°ch c√≥ m·ª©c ƒë·ªô h√†i l√≤ng r·∫•t cao v·ªÅ tr·∫£i nghi·ªám t·∫°i L√†ng hoa Sa ƒê√©c. ƒê√¢y l√† n·ªÅn t·∫£ng v·ªØng ch·∫Øc ƒë·ªÉ ph√°t tri·ªÉn th√™m nhi·ªÅu s·∫£n ph·∫©m du l·ªãch m·ªõi.`,
          });
        } else if (satisfactionMean >= 3.5) {
          insights.push({
            icon: "‚úÖ",
            title: "M·ª©c ƒë·ªô h√†i l√≤ng t·ªët",
            text: `ƒêi·ªÉm h√†i l√≤ng ${satisfactionMean.toFixed(
              2
            )}/5.0 cho th·∫•y du kh√°ch c√≥ tr·∫£i nghi·ªám t√≠ch c·ª±c. T·∫≠p trung c·∫£i thi·ªán c√°c ƒëi·ªÉm y·∫øu s·∫Ω n√¢ng cao ƒë√°ng k·ªÉ s·ª± h√†i l√≤ng.`,
          });
        } else if (satisfactionMean >= 3.0) {
          insights.push({
            icon: "üìä",
            title: "M·ª©c ƒë·ªô h√†i l√≤ng trung b√¨nh",
            text: `ƒêi·ªÉm h√†i l√≤ng ${satisfactionMean.toFixed(
              2
            )}/5.0 cho th·∫•y c·∫ßn c√≥ k·∫ø ho·∫°ch c·∫£i thi·ªán r√µ r√†ng. ∆Øu ti√™n c√°c y·∫øu t·ªë c√≥ ƒëi·ªÉm th·∫•p nh·∫•t ƒë·ªÉ t·∫°o ƒë·ªôt ph√°.`,
          });
        } else {
          insights.push({
            icon: "‚ö†Ô∏è",
            title: "C·∫ßn c·∫£i thi·ªán kh·∫©n c·∫•p",
            text: `ƒêi·ªÉm h√†i l√≤ng ${satisfactionMean.toFixed(
              2
            )}/5.0 c·∫ßn ƒë∆∞·ª£c ch√∫ √Ω ngay. Xem x√©t to√†n di·ªán ch·∫•t l∆∞·ª£ng d·ªãch v·ª• v√† tr·∫£i nghi·ªám du kh√°ch.`,
          });
        }

        if (returnRate >= 80) {
          insights.push({
            icon: "üéØ",
            title: "L√≤ng trung th√†nh kh√°ch h√†ng cao",
            text: `${returnRate.toFixed(
              1
            )}% du kh√°ch s·∫µn s√†ng quay l·∫°i - ch·ªâ s·ªë l√≤ng trung th√†nh xu·∫•t s·∫Øc! ƒê√¢y l√† t√†i s·∫£n v√¥ gi√° cho s·ª± ph√°t tri·ªÉn b·ªÅn v·ªØng.`,
          });
        } else if (returnRate >= 60) {
          insights.push({
            icon: "üëç",
            title: "Ti·ªÅm nƒÉng t√°i kh√°ch t·ªët",
            text: `${returnRate.toFixed(
              1
            )}% du kh√°ch s·∫µn s√†ng quay l·∫°i cho th·∫•y ƒëi·ªÉm ƒë·∫øn c√≥ s·ª©c h√∫t nh·∫•t ƒë·ªãnh. C·∫£i thi·ªán d·ªãch v·ª• s·∫Ω tƒÉng t·ª∑ l·ªá n√†y cao h∆°n.`,
          });
        }

        if (expRate >= 70) {
          insights.push({
            icon: "üå±",
            title: "C∆° h·ªôi ph√°t tri·ªÉn tr·∫£i nghi·ªám l·ªõn",
            text: `${expRate.toFixed(
              1
            )}% du kh√°ch quan t√¢m ƒë·∫øn tr·∫£i nghi·ªám n√¥ng nghi·ªáp - ƒë√¢y l√† t√≠n hi·ªáu r·∫•t t√≠ch c·ª±c! N√™n ƒë·∫ßu t∆∞ m·∫°nh v√†o c√°c s·∫£n ph·∫©m tr·∫£i nghi·ªám ƒëa d·∫°ng.`,
          });
        } else if (expRate >= 50) {
          insights.push({
            icon: "üåæ",
            title: "Nhu c·∫ßu tr·∫£i nghi·ªám kh·∫£ quan",
            text: `${expRate.toFixed(
              1
            )}% du kh√°ch quan t√¢m ƒë·∫øn tr·∫£i nghi·ªám. C·∫ßn marketing hi·ªáu qu·∫£ v√† s·∫£n ph·∫©m ch·∫•t l∆∞·ª£ng ƒë·ªÉ thu h√∫t ph√¢n kh√∫c n√†y.`,
          });
        }

        if (refRate >= 75) {
          insights.push({
            icon: "üí¨",
            title: "Ti·ªÅm nƒÉng lan t·ªèa m·∫°nh m·∫Ω",
            text: `${refRate.toFixed(
              1
            )}% du kh√°ch s·∫µn s√†ng gi·ªõi thi·ªáu - ƒë√¢y l√† l·ª£i th·∫ø c·∫°nh tranh kh·ªïng l·ªì! Word-of-mouth marketing s·∫Ω mang l·∫°i kh√°ch h√†ng m·ªõi v·ªõi chi ph√≠ th·∫•p.`,
          });
        } else if (refRate >= 60) {
          insights.push({
            icon: "üì¢",
            title: "Kh·∫£ nƒÉng gi·ªõi thi·ªáu t·ªët",
            text: `${refRate.toFixed(
              1
            )}% s·∫µn s√†ng gi·ªõi thi·ªáu b·∫°n b√®. TƒÉng c∆∞·ªùng tr·∫£i nghi·ªám v√† t·∫°o ƒëi·ªÉm nh·∫•n ƒë·ªôc ƒë√°o s·∫Ω bi·∫øn h·ªç th√†nh "ƒë·∫°i s·ª© th∆∞∆°ng hi·ªáu".`,
          });
        }

        const container = document.getElementById("keyInsights");
        if (container && insights.length > 0) {
          container.innerHTML = insights
            .map(
              (insight) => `
                <div class="insight-card">
                  <h4>${insight.icon} ${insight.title}</h4>
                  <p>${insight.text}</p>
                </div>
              `
            )
            .join("");
        }
      }

      // ===================================================================
      // PH·∫¶N 4: H√ÄM X·ª¨ L√ù CH√çNH (ƒê√É S·ª¨A L·ªñI)
      // ===================================================================

      /**
       * FIX:
       * 1. ƒê√£ thay th·∫ø TO√ÄN B·ªò c√°c chu·ªói hardcode (v√≠ d·ª•: "2. ƒê·ªô tu·ªïi:")
       * b·∫±ng c√°ch g·ªçi 'getColumnByLetter' (v√≠ d·ª•: 'ageCol').
       * 2. ƒê√£ s·ª≠a logic truy·ªÅn d·ªØ li·ªáu v√†o 'generateInsights',
       * truy·ªÅn S·ªê (number) thay v√¨ chu·ªói (string).
       * 3. S·ª≠a logic popularAgeGroup, expYes, priceRanges
       */
      function processAllData() {
        const d = globalData;
        document.getElementById("totalResponses").textContent = d.length;

        if (d.length === 0) {
          console.warn("Kh√¥ng c√≥ d·ªØ li·ªáu kh·∫£o s√°t ƒë·ªÉ x·ª≠ l√Ω.");
          document.getElementById("popularAgeGroup").textContent = "N/A";
          return;
        }

        // --- B·∫Øt ƒë·∫ßu ph·∫ßn refactor ---
        // L·∫•y t√™n c·ªôt m·ªôt c√°ch an to√†n
        const ageCol = getColumnByLetter("C");
        const occupationCol = getColumnByLetter("E");
        const locationCol = getColumnByLetter("D");
        const returnCol = getColumnByLetter("AJ");
        const expCol = getColumnByLetter("X");
        const refCol = getColumnByLetter("AI");
        const priceCol = getColumnByLetter("AF");

        const ageCounts = {};
        d.forEach((row) => {
          // FIX: D√πng ageCol
          const ageGroup = row[ageCol];
          if (ageGroup) ageCounts[ageGroup] = (ageCounts[ageGroup] || 0) + 1;
        });

        // FIX: S·ª≠a logic ƒë·ªÉ x·ª≠ l√Ω tr∆∞·ªùng h·ª£p b·∫±ng nhau
        let popularAgeGroups = [],
          maxCount = 0;
        for (const ageGroup in ageCounts) {
          if (ageCounts[ageGroup] > maxCount) {
            maxCount = ageCounts[ageGroup];
            popularAgeGroups = [ageGroup];
          } else if (ageCounts[ageGroup] === maxCount) {
            popularAgeGroups.push(ageGroup);
          }
        }
        document.getElementById("popularAgeGroup").textContent =
          popularAgeGroups.length > 0 ? popularAgeGroups.join(" & ") : "N/A";

        // T√≠nh Mean v√† SD t·ªïng th·ªÉ (C√¢u 12)
        const satKeys = ["M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W"];
        let overallTotalScore = 0;
        let overallCount = 0;

        satKeys.forEach((letter) => {
          const colName = getColumnByLetter(letter);
          if (colName) {
            d.forEach((row) => {
              const val = String(row[colName] || "")
                .trim()
                .toLowerCase();
              const score = scoreMap[val];
              if (score) {
                overallTotalScore += score;
                overallCount++;
              }
            });
          }
        });

        const overallMean =
          overallCount > 0 ? overallTotalScore / overallCount : 0;

        let overallSumSqDev = 0;
        satKeys.forEach((letter) => {
          const colName = getColumnByLetter(letter);
          if (colName) {
            d.forEach((row) => {
              const val = String(row[colName] || "")
                .trim()
                .toLowerCase();
              const score = scoreMap[val];
              if (score) {
                const deviation = score - overallMean;
                overallSumSqDev += deviation * deviation;
              }
            });
          }
        });

        const overallVariance =
          overallCount > 1 ? overallSumSqDev / (overallCount - 1) : 0;
        const overallStdDev = Math.sqrt(overallVariance);

        document.getElementById("satisfactionRate").innerHTML = `
              <span title="ƒêi·ªÉm trung b√¨nh">${overallMean.toFixed(2)}</span>
              <span class="text-xl text-gray-500" title="ƒê·ªô l·ªách chu·∫©n">(s=${overallStdDev.toFixed(
                2
              )})</span>
            `;

        // Ph√¢n t√≠ch c√°c th·∫ª th·ªëng k√™
        const returnYes = d.filter((row) => {
          // FIX: D√πng returnCol
          const val = row[returnCol];
          if (!val) return false;
          const valLower = String(val).toLowerCase();
          return valLower.includes("c√≥") || valLower.includes("ch·∫Øc ch·∫Øn");
        }).length;

        const expYes = d.filter((row) => {
          // FIX: D√πng expCol v√† s·ª≠a logic ƒë·∫øm
          const val = row[expCol];
          if (!val) return false;
          const valLower = String(val).toLowerCase();
          return valLower === "quan t√¢m" || valLower === "r·∫•t quan t√¢m";
        }).length;

        const refYes = d.filter((row) => {
          // FIX: D√πng refCol
          const val = row[refCol];
          if (!val) return false;
          const valLower = String(val).toLowerCase();
          return (
            valLower.includes("c√≥") || valLower === "4" || valLower === "5"
          );
        }).length;

        // FIX: T√≠nh to√°n S·ªê, sau ƒë√≥ m·ªõi ƒë·ªãnh d·∫°ng chu·ªói
        const returnRateNum = (returnYes / d.length) * 100;
        const expRateNum = (expYes / d.length) * 100;
        const refRateNum = (refYes / d.length) * 100;

        // C·∫≠p nh·∫≠t UI
        document.getElementById("returnRate").textContent =
          returnRateNum.toFixed(1) + "%";
        document.getElementById("expInterestPercent").textContent =
          expRateNum.toFixed(1) + "%";
        document.getElementById("referralPercent").textContent =
          refRateNum.toFixed(1) + "%";

        // FIX: S·ª≠a key c·ªßa priceRanges ƒë·ªÉ kh·ªõp v·ªõi data.json
        const priceRanges = {
          "100.000 - 200.000 VNƒê": 150000,
          "200.000 - 300.000 VNƒê": 250000,
          "Tr√™n 300.000 VNƒê": 350000,
          "D∆∞·ªõi 100.000 VNƒê": 80000,
        };
        let totalPrice = 0,
          priceCount = 0;
        d.forEach((row) => {
          // FIX: D√πng priceCol v√† kh√¥ng .toLowerCase()
          const val = String(row[priceCol] || "").trim();
          if (val && priceRanges[val]) {
            totalPrice += priceRanges[val];
            priceCount++;
          }
        });
        const avgPrice =
          priceCount > 0 ? Math.round(totalPrice / priceCount) : 0;
        document.getElementById("avgPrice").textContent =
          avgPrice > 0 ? (avgPrice / 1000).toFixed(0) + "K VNƒê" : "N/A";

        // FIX: Truy·ªÅn S·ªê (number) v√†o 'generateInsights'
        generateInsights(d, overallMean, returnRateNum, expRateNum, refRateNum);

        // FIX: D√πng t√™n c·ªôt ƒë√£ l·∫•y
        renderTopList(d, occupationCol, "topOccupations");
        renderTopList(d, locationCol, "topLocations");
        // --- K·∫øt th√∫c ph·∫ßn refactor ---

        renderPieChart(d, "B", "genderChart", "doughnut");
        renderBarChart(d, "C", "ageChart");
        renderBarChart(d, "E", "occupationChart", true);
        renderBarChart(d, "D", "locationChart", true);

        renderPieChart(d, "F", "visitFrequencyChart", "pie");
        renderPieChart(d, "H", "companionChart", "doughnut");
        renderPieChart(d, "J", "travelTypeChart", "polarArea");
        renderBarChart(d, "K", "stayDurationChart");
        renderMultiChart(d, "G", "sourceChart");
        renderMultiChart(d, "I", "purposeChart");
        renderMultiChart(d, "L", "activitiesChart");

        const satOrder = [
          "R·∫•t h√†i l√≤ng",
          "H√†i l√≤ng",
          "B√¨nh th∆∞·ªùng",
          "Kh√¥ng h√†i l√≤ng",
          "R·∫•t kh√¥ng h√†i l√≤ng",
        ];

        const satLetters = [
          "M",
          "N",
          "O",
          "P",
          "Q",
          "R",
          "S",
          "T",
          "U",
          "V",
          "W",
        ];
        satLetters.forEach((letter, idx) => {
          const colName = getColumnByLetter(letter);
          const mean = getMeanScore(d, colName);
          const stdDev = getStandardDeviation(d, colName, mean);
          document.getElementById(`sat${idx + 1}Mean`).textContent =
            mean.toFixed(2);
          document.getElementById(
            `sat${idx + 1}StdDev`
          ).textContent = `(s=${stdDev.toFixed(2)})`;
          renderOrderedChart(d, letter, `sat${idx + 1}Chart`, satOrder);
        });

        const interestMapping = {
          5: "R·∫•t quan t√¢m",
          4: "Quan t√¢m",
          3: "B√¨nh th∆∞·ªùng",
          2: "Kh√¥ng quan t√¢m",
          1: "Ho√†n to√†n kh√¥ng quan t√¢m",
        };
        renderMappedPieChart(
          d,
          "X",
          "expInterestChart",
          "doughnut",
          interestMapping
        );
        renderBarChart(d, "AF", "priceRangeChart");

        const interestCols = ["Y", "Z", "AA", "AB", "AC", "AD", "AE"];
        renderMeanList(d, interestCols, "interestMeanList");

        const interestOrder = [
          "R·∫•t quan t√¢m",
          "Quan t√¢m",
          "B√¨nh th∆∞·ªùng",
          "Kh√¥ng quan t√¢m",
          "Ho√†n to√†n kh√¥ng quan t√¢m",
        ];

        interestCols.forEach((letter, idx) => {
          const colName = getColumnByLetter(letter);
          const mean = getMeanScore(d, colName);
          const stdDev = getStandardDeviation(d, colName, mean);
          document.getElementById(`int${idx + 1}Mean`).textContent =
            mean.toFixed(2);
          document.getElementById(
            `int${idx + 1}StdDev`
          ).textContent = `(s=${stdDev.toFixed(2)})`;
          renderOrderedChart(d, letter, `int${idx + 1}Chart`, interestOrder);
        });

        renderMultiChart(d, "AG", "attractionFactorsChart");
        renderMultiChart(d, "AH", "improvementChart");

        const referralMapping = {
          5: "R·∫•t s·∫µn l√≤ng",
          4: "S·∫µn l√≤ng",
          3: "B√¨nh th∆∞·ªùng",
          2: "Kh√¥ng s·∫µn l√≤ng",
          1: "Ch·∫Øc ch·∫Øn kh√¥ng",
          C√≥: "C√≥",
          "Ch·∫Øc ch·∫Øn c√≥": "Ch·∫Øc ch·∫Øn c√≥",
          "Ch∆∞a ch·∫Øc ch·∫Øn/C√≤n ph√¢n v√¢n": "Ch∆∞a ch·∫Øc ch·∫Øn/C√≤n ph√¢n v√¢n",
          Kh√¥ng: "Kh√¥ng",
          "Ho√†n to√†n kh√¥ng": "Ho√†n to√†n kh√¥ng",
        };
        renderMappedPieChart(
          d,
          "AI",
          "referralChart",
          "doughnut",
          referralMapping
        );
        renderPieChart(d, "AJ", "returnChart", "doughnut");
        renderFeedbackList(d, "AK", "AL", "feedbackListBox");
      }

      // ===================================================================
      // PH·∫¶N 5: C√ÅC H√ÄM V·∫º BI·ªÇU ƒê·ªí (ƒê√É S·ª¨A L·ªñI)
      // ===================================================================

      // FIX: S·ª≠a l·∫°i h√†m n√†y ƒë·ªÉ ch·∫•p nh·∫≠n colName tr·ª±c ti·∫øp
      // (H√†m g·ªçi trong processAllData ƒë√£ ƒë∆∞·ª£c s·ª≠a)
      function renderTopList(data, colName, elementId, top = 5) {
        if (!colName) return;
        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) counts[val] = (counts[val] || 0) + 1;
        });
        const sorted = Object.entries(counts)
          .sort(([, a], [, b]) => b - a)
          .slice(0, top);
        const max = sorted[0] ? sorted[0][1] : 1;

        const html = sorted
          .map(
            ([label, count], i) => `
                    <div class="top-item mb-3">
                        <div class="flex justify-between mb-2">
                            <span class="font-semibold text-sm text-gray-800">${label}</span>
                            <span class="text-sm text-purple-600 font-bold">${count} ng∆∞·ªùi (${(
              (count / data.length) *
              100
            ).toFixed(1)}%)</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${
                              (count / max) * 100
                            }%; background: ${colors[i % colors.length]}"></div>
                        </div>
                    </div>
                  `
          )
          .join("");
        document.getElementById(elementId).innerHTML = html;
      }

      function renderMeanList(data, colLetters, elementId) {
        const container = document.getElementById(elementId);
        if (!container) return;

        const meanData = colLetters
          .map((letter) => {
            const colName = getColumnByLetter(letter);
            if (!colName) return null;

            const labelMatch = colName.match(/\[(.*?)\]/);
            const label = labelMatch ? labelMatch[1] : colName;
            const mean = getMeanScore(data, colName);
            const stdDev = getStandardDeviation(data, colName, mean);
            return { label, mean, stdDev };
          })
          .filter((item) => item && item.mean > 0)
          .sort((a, b) => b.mean - a.mean);

        const maxMean = 5;

        const html = meanData
          .map(
            ({ label, mean, stdDev }, i) => `
                    <div class="top-item mb-3">
                      <div class="flex justify-between mb-2">
                        <span class="font-semibold text-sm text-gray-800">${label}</span>
                        <div class="flex items-baseline flex-shrink-0 ml-2">
                          <span class="text-sm text-purple-600 font-bold" title="ƒêi·ªÉm trung b√¨nh">${mean.toFixed(
                            2
                          )}</span>
                          <span class="text-xs text-gray-500 font-medium ml-1" title="ƒê·ªô l·ªách chu·∫©n">(s=${stdDev.toFixed(
                            2
                          )})</span>
                        </div>
                      </div>
                      <div class="progress-bar">
                        <div class="progress-fill" style="width: ${
                          (mean / maxMean) * 100
                        }%; background: ${colors[i % colors.length]}"></div>
                      </div>
                    </div>
                  `
          )
          .join("");

        container.innerHTML = html;
      }

      // FIX: Th√™m logic getColumnByLetter
      function renderPieChart(data, colLetter, canvasId, type) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(`(Pie) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`);
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) counts[val] = (counts[val] || 0) + 1;
        });

        createChart(
          canvasId,
          type,
          Object.keys(counts),
          Object.values(counts),
          true
        );
      }

      // FIX: Th√™m logic getColumnByLetter
      function renderBarChart(data, colLetter, canvasId, sort = false) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(`(Bar) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`);
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) counts[val] = (counts[val] || 0) + 1;
        });

        let entries = Object.entries(counts);
        if (sort) entries = entries.sort(([, a], [, b]) => b - a);

        createChart(
          canvasId,
          "bar",
          entries.map((e) => e[0]),
          entries.map((e) => e[1]),
          false
        );
      }

      // FIX: Th√™m logic getColumnByLetter
      function renderOrderedChart(data, colLetter, canvasId, order) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(
            `(Ordered) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`
          );
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = String(row[colName] || "")
            .trim()
            .toLowerCase();
          if (val) counts[val] = (counts[val] || 0) + 1;
        });

        const labels = order;
        const values = order.map((label) => counts[label.toLowerCase()] || 0);

        createChart(canvasId, "bar", labels, values, false);
      }

      // FIX: Th√™m logic getColumnByLetter
      function renderMultiChart(data, colLetter, canvasId) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(`(Multi) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`);
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) {
            const answers = smartSplitAnswers(val);
            answers.forEach((item) => {
              if (item) counts[item] = (counts[item] || 0) + 1;
            });
          }
        });

        const sorted = Object.entries(counts).sort(([, a], [, b]) => b - a);
        createChart(
          canvasId,
          "bar",
          sorted.map((e) => e[0]),
          sorted.map((e) => e[1]),
          false,
          true
        );
      }

      // FIX: Th√™m logic getColumnByLetter
      function renderFeedbackList(
        data,
        feelingColLetter,
        suggestionColLetter,
        elementId
      ) {
        const feelingCol = getColumnByLetter(feelingColLetter);
        const suggestionCol = getColumnByLetter(suggestionColLetter);
        const container = document.getElementById(elementId);

        if (!feelingCol || !suggestionCol || !container) {
          console.error(
            "Kh√¥ng t√¨m th·∫•y c·ªôt ho·∫∑c element cho danh s√°ch feedback."
          );
          return;
        }

        const feedbackItems = data
          .map((row, i) => {
            const feeling = row[feelingCol] || null;
            const suggestion = row[suggestionCol] || null;

            const hasMeaningfulSuggestion =
              suggestion &&
              suggestion.trim().length > 3 &&
              !suggestion.trim().toLowerCase().startsWith("kh√¥ng") &&
              !suggestion.trim().toLowerCase().startsWith("kh a") &&
              !suggestion.trim().toLowerCase().startsWith("ko");

            const hasMeaningfulFeeling =
              feeling &&
              feeling.trim().length > 3 &&
              !feeling.trim().toLowerCase().startsWith("kh√¥ng") &&
              !feeling.trim().toLowerCase().startsWith("ko");

            if (hasMeaningfulFeeling || hasMeaningfulSuggestion) {
              return `
                <div class="feedback-card p-5 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border-l-4 border-purple-500 shadow-md">
                    <div class="flex items-start gap-4 mb-4">
                        <span class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full flex items-center justify-center font-bold text-lg shadow-md" title="C·∫£m nh·∫≠n">üòä</span>
                        <div class="text-gray-700 text-sm leading-relaxed w-full">
                            <strong class="text-gray-900 text-base">üí≠ C·∫£m nh·∫≠n chuy·∫øn ƒëi:</strong>
                            <p class="mt-2 text-gray-800">${
                              feeling ||
                              "<em class='text-gray-400'>(Kh√¥ng c√≥)</em>"
                            }</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-4 pt-4 border-t border-gray-200">
                        <span class="flex-shrink-0 w-10 h-10 bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-full flex items-center justify-center font-bold text-lg shadow-md" title="ƒê·ªÅ xu·∫•t">üí°</span>
                        <div class="text-gray-700 text-sm leading-relaxed w-full">
                            <strong class="text-gray-900 text-base">üìù ƒê·ªÅ xu·∫•t c·∫£i thi·ªán:</strong>
                            <p class="mt-2 text-gray-800">${
                              suggestion ||
                              "<em class='text-gray-400'>(Kh√¥ng c√≥)</em>"
                            }</p>
                        </div>
                    </div>
                </div>
              `;
            }
            return "";
          })
          .join("");

        container.innerHTML =
          feedbackItems.length > 0
            ? feedbackItems
            : '<div class="text-center py-12 bg-gray-50 rounded-xl"><p class="text-gray-500 text-lg">üì≠ Ch∆∞a c√≥ c·∫£m nh·∫≠n ho·∫∑c ƒë·ªÅ xu·∫•t n√†o.</p></div>';
      }

      // FIX: Th√™m logic getColumnByLetter
      function renderMappedPieChart(data, colLetter, canvasId, type, mapping) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(
            `(MappedPie) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`
          );
          return;
        }

        const counts = {};
        const orderedLabels = Object.values(mapping);
        orderedLabels.forEach((label) => {
          counts[label] = 0;
        });

        data.forEach((row) => {
          const val = String(row[colName]).trim();
          let label = mapping[val];
          if (!label) {
            const foundLabel = Object.values(mapping).find(
              (l) => l.toLowerCase() === val.toLowerCase()
            );
            if (foundLabel) label = foundLabel;
          }
          if (label) {
            counts[label] = (counts[label] || 0) + 1;
          }
        });

        const finalLabels = [];
        const finalValues = [];
        for (const label of orderedLabels) {
          // Ch·ªâ th√™m v√†o bi·ªÉu ƒë·ªì n·∫øu c√≥ gi√° tr·ªã V√Ä mapping c√≥ key ƒë√≥
          if (counts[label] > 0 && Object.values(mapping).includes(label)) {
            finalLabels.push(label);
            finalValues.push(counts[label]);
          }
        }

        // S·∫Øp x·∫øp l·∫°i finalLabels cho C√¢u 18 (AI) v√† 13 (X)
        if (colLetter === "AI" || colLetter === "X") {
          const desiredOrder =
            colLetter === "AI"
              ? [
                  "Ch·∫Øc ch·∫Øn c√≥",
                  "C√≥",
                  "Ch∆∞a ch·∫Øc ch·∫Øn/C√≤n ph√¢n v√¢n",
                  "Kh√¥ng",
                  "Ho√†n to√†n kh√¥ng",
                ]
              : [
                  "R·∫•t quan t√¢m",
                  "Quan t√¢m",
                  "B√¨nh th∆∞·ªùng",
                  "Kh√¥ng quan t√¢m",
                  "Ho√†n to√†n kh√¥ng quan t√¢m",
                ];

          const sortedData = finalLabels
            .map((label, index) => ({
              label: label,
              value: finalValues[index],
            }))
            .sort((a, b) => {
              return (
                desiredOrder.indexOf(a.label) - desiredOrder.indexOf(b.label)
              );
            });

          createChart(
            canvasId,
            type,
            sortedData.map((d) => d.label),
            sortedData.map((d) => d.value),
            true
          );
        } else {
          createChart(canvasId, type, finalLabels, finalValues, true);
        }
      }

      function createChart(
        canvasId,
        type,
        labels,
        data,
        isPie = false,
        horizontal = false
      ) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) {
          console.error(`Kh√¥ng t√¨m th·∫•y canvas: ${canvasId}`);
          return;
        }

        if (charts[canvasId]) charts[canvasId].destroy();

        const ctx = canvas.getContext("2d");

        const config = {
          type: horizontal ? "bar" : type,
          data: {
            labels: labels,
            datasets: [
              {
                label: "S·ªë l∆∞·ª£ng",
                data: data,
                backgroundColor: isPie
                  ? labels.map((_, i) => colors[i % colors.length])
                  : labels.map((_, i) => colors[i % colors.length] + "CC"),
                borderColor: isPie
                  ? "#fff"
                  : labels.map((_, i) => colors[i % colors.length]),
                borderWidth: isPie ? 3 : 2,
                borderRadius: isPie ? 0 : 10,
                hoverOffset: isPie ? 25 : 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: {
              duration: 1200,
              easing: "easeInOutQuart",
            },
            plugins: {
              legend: {
                display: isPie,
                position: "bottom",
                labels: {
                  padding: 18,
                  font: { size: 13, weight: "600", family: "Inter" },
                  usePointStyle: true,
                  pointStyle: "circle",
                  boxWidth: 12,
                  color: "#333",
                },
              },
              tooltip: {
                backgroundColor: "rgba(0, 0, 0, 0.9)",
                padding: 16,
                titleFont: { size: 15, weight: "bold", family: "Inter" },
                bodyFont: { size: 14, family: "Inter" },
                cornerRadius: 12,
                displayColors: true,
                boxPadding: 6,
                callbacks: {
                  label: function (context) {
                    const label = context.label || "";
                    const value = context.parsed.y || context.parsed;
                    const total = context.dataset.data.reduce(
                      (a, b) => a + b,
                      0
                    );
                    const percentage = ((value / total) * 100).toFixed(1);
                    return `  ${label}: ${value} (${percentage}%)`;
                  },
                },
              },
            },
            scales: isPie
              ? {}
              : {
                  x: {
                    display: true,
                    grid: { display: false },
                    ticks: {
                      font: { size: 12, weight: "600", family: "Inter" },
                      autoSkip: false,
                      maxRotation: horizontal ? 0 : 45,
                      minRotation: horizontal ? 0 : 45,
                      color: "#333",
                    },
                  },
                  y: {
                    display: true,
                    beginAtZero: true,
                    grid: {
                      color: "rgba(0, 0, 0, 0.06)",
                      drawBorder: false,
                      lineWidth: 1,
                    },
                    ticks: {
                      font: { size: 12, weight: "600", family: "Inter" },
                      precision: 0,
                      color: "#333",
                      padding: 8,
                    },
                  },
                },
          },
        };

        if (horizontal) {
          config.options.indexAxis = "y";
          config.options.scales.x.beginAtZero = true;
          config.options.scales.y.ticks.autoSkip = false;
        }

        charts[canvasId] = new Chart(ctx, config);
      }

      function showSection(sectionId, button) {
        document.querySelectorAll(".section-content").forEach((section) => {
          section.classList.remove("active");
        });

        document.querySelectorAll(".nav-btn").forEach((btn) => {
          btn.classList.remove("active");
        });

        document.getElementById(sectionId + "-section").classList.add("active");
        button.classList.add("active");

        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function exportSummary() {
        const satMeanElement = document.getElementById("satisfactionRate");
        const satMeanText =
          satMeanElement.textContent || satMeanElement.innerText;
        const interestMeanList = document.getElementById("interestMeanList");
        let interestSummary = "N/A";

        if (interestMeanList && interestMeanList.children.length > 0) {
          const topItem = interestMeanList.children[0];
          const topLabel = topItem.querySelector(".font-semibold").textContent;
          const topScoreText =
            topItem.querySelector(".flex-shrink-0").innerText;
          interestSummary = `${topLabel} (${topScoreText.replace("\n", " ")})`;
        }

        const summary = `
      ‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
      ‚ïë                                                                    ‚ïë
      ‚ïë                   B√ÅO C√ÅO T√ìM T·∫ÆT KH·∫¢O S√ÅT DU L·ªäCH                   ‚ïë
      ‚ïë         Ph√°t tri·ªÉn s·∫£n ph·∫©m du l·ªãch n√¥ng nghi·ªáp tr·∫£i nghi·ªám          ‚ïë
      ‚ïë                L√†ng hoa Sa ƒê√©c, t·ªânh ƒê·ªìng Th√°p                       ‚ïë
      ‚ïë                                                                    ‚ïë
      ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      üìä T·ªîNG QUAN KH·∫¢O S√ÅT
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

        ‚ñ∏ T·ªïng s·ªë ph·∫£n h·ªìi:       ${
          document.getElementById("totalResponses").textContent
        } ng∆∞·ªùi
        ‚ñ∏ Nh√≥m tu·ªïi ph·ªï bi·∫øn:      ${
          document.getElementById("popularAgeGroup").textContent
        }
        ‚ñ∏ ƒêi·ªÉm h√†i l√≤ng t·ªïng th·ªÉ:  ${satMeanText.replace("\n", " ")}
        ‚ñ∏ T·ª∑ l·ªá s·∫µn s√†ng quay l·∫°i: ${
          document.getElementById("returnRate").textContent
        }

      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      üìà NH·ªÆNG PH√ÅT HI·ªÜN QUAN TR·ªåNG
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

        1. Nhu c·∫ßu tr·∫£i nghi·ªám n√¥ng nghi·ªáp
           ‚Üí ${
             document.getElementById("expInterestPercent").textContent
           } du kh√°ch quan t√¢m

        2. Kh·∫£ nƒÉng gi·ªõi thi·ªáu b·∫°n b√®
           ‚Üí ${
             document.getElementById("referralPercent").textContent
           } s·∫µn s√†ng gi·ªõi thi·ªáu

        3. M·ª©c gi√° ch·∫•p nh·∫≠n (trung b√¨nh)
           ‚Üí ${document.getElementById("avgPrice").textContent}/ng∆∞·ªùi

        4. Ho·∫°t ƒë·ªông ƒë∆∞·ª£c quan t√¢m nh·∫•t
           ‚Üí ${interestSummary}

      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      üéØ PH√ÇN T√çCH & ƒê√ÅNH GI√Å
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

      ‚úì ƒêI·ªÇM M·∫†NH
        ‚Ä¢ M·ª©c ƒë·ªô h√†i l√≤ng c·ªßa du kh√°ch ·ªü m·ª©c ${satMeanText
          .split("(")[0]
          .trim()}/5.0
        ‚Ä¢ T·ª∑ l·ªá du kh√°ch s·∫µn s√†ng quay l·∫°i cao
        ‚Ä¢ Nhu c·∫ßu tr·∫£i nghi·ªám n√¥ng nghi·ªáp r√µ r√†ng
        ‚Ä¢ Ti·ªÅm nƒÉng lan t·ªèa th√¥ng qua word-of-mouth t·ªët

      ‚ö° C∆† H·ªòI PH√ÅT TRI·ªÇN
        ‚Ä¢ ƒêa d·∫°ng h√≥a s·∫£n ph·∫©m du l·ªãch tr·∫£i nghi·ªám
        ‚Ä¢ Ph√°t tri·ªÉn c√°c g√≥i tour theo ch·ªß ƒë·ªÅ
        ‚Ä¢ T·∫≠n d·ª•ng m·∫°ng l∆∞·ªõi kh√°ch h√†ng trung th√†nh
        ‚Ä¢ X√¢y d·ª±ng th∆∞∆°ng hi·ªáu du l·ªãch n√¥ng nghi·ªáp ƒë·ªôc ƒë√°o

      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      üí° KHUY·∫æN NGH·ªä CHI·∫æN L∆Ø·ª¢C
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

      1. PH√ÅT TRI·ªÇN S·∫¢N PH·∫®M
         ‚Üí ∆Øu ti√™n c√°c ho·∫°t ƒë·ªông c√≥ ƒëi·ªÉm quan t√¢m cao nh·∫•t
         ‚Üí Thi·∫øt k·∫ø g√≥i tr·∫£i nghi·ªám 2-3 ti·∫øng v·ªõi gi√° h·ª£p l√Ω
         ‚Üí T√≠ch h·ª£p y·∫øu t·ªë vƒÉn h√≥a ƒë·ªãa ph∆∞∆°ng

      2. N√ÇNG CAO CH·∫§T L∆Ø·ª¢NG D·ªäCH V·ª§
         ‚Üí C·∫£i thi·ªán c√°c y·∫øu t·ªë c√≥ ƒëi·ªÉm h√†i l√≤ng th·∫•p
         ‚Üí ƒê√†o t·∫°o ƒë·ªôi ng≈© h∆∞·ªõng d·∫´n vi√™n chuy√™n nghi·ªáp
         ‚Üí ƒê·∫ßu t∆∞ c∆° s·ªü v·∫≠t ch·∫•t v√† ti·ªán √≠ch

      3. MARKETING & TRUY·ªÄN TH√îNG
         ‚Üí T·∫≠n d·ª•ng marketing truy·ªÅn mi·ªáng
         ‚Üí Ph√°t tri·ªÉn n·ªôi dung s·ªë h·∫•p d·∫´n
         ‚Üí H·ª£p t√°c v·ªõi travel influencers

      4. QU·∫¢N L√ù KH√ÅCH H√ÄNG
         ‚Üí X√¢y d·ª±ng ch∆∞∆°ng tr√¨nh kh√°ch h√†ng th√¢n thi·∫øt
         ‚Üí Thu th·∫≠p ph·∫£n h·ªìi li√™n t·ª•c
         ‚Üí C√° nh√¢n h√≥a tr·∫£i nghi·ªám du kh√°ch

      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
      üìå TH√îNG TIN B√ÅO C√ÅO
      ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

        Ngu·ªìn:     Dashboard Ph√¢n T√≠ch Kh·∫£o S√°t
        ƒê∆°n v·ªã:     Tr∆∞·ªùng ƒê·∫°i h·ªçc C√¥ng Nghi·ªáp TP.HCM
        Khoa:       Th∆∞∆°ng m·∫°i - Du l·ªãch
        Ng√†nh:      Qu·∫£n tr·ªã d·ªãch v·ª• du l·ªãch v√† l·ªØ h√†nh
        Ng√†y xu·∫•t:  ${new Date().toLocaleDateString("vi-VN", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        })}

      ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
        `;

        const blob = new Blob([summary], {
          type: "text/plain;charset=utf-8",
        });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = `Bao_Cao_Khao_Sat_Lang_Hoa_Sa_Dec_${new Date().getTime()}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);

        // Show success notification
        const notification = document.createElement("div");
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: black;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(67, 233, 123, 0.4);
            z-index: 10000;
            font-weight: 600;
            animation: slideIn 0.3s ease-out;
          `;
        notification.innerHTML = "‚úÖ ƒê√£ xu·∫•t b√°o c√°o th√†nh c√¥ng!";
        document.body.appendChild(notification);

        setTimeout(() => {
          notification.style.animation = "slideOut 0.3s ease-out";
          setTimeout(() => notification.remove(), 300);
        }, 3000);
      }
    </script>
  </body>
</html>

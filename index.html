<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard Kh·∫£o S√°t - L√†ng Hoa Sa ƒê√©c</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        position: relative;
        overflow-x: hidden;
      }
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: radial-gradient(
            circle at 20% 50%,
            rgba(102, 126, 234, 0.3) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 80% 80%,
            rgba(118, 75, 162, 0.3) 0%,
            transparent 50%
          ),
          radial-gradient(
            circle at 40% 20%,
            rgba(240, 147, 251, 0.2) 0%,
            transparent 40%
          );
        animation: gradientShift 15s ease infinite;
        pointer-events: none;
        z-index: 0;
      }
      @keyframes gradientShift {
        0%,
        100% {
          opacity: 1;
          transform: scale(1);
        }
        50% {
          opacity: 0.8;
          transform: scale(1.1);
        }
      }
      .glassmorphism {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px) saturate(180%);
        border: 1px solid rgba(255, 255, 255, 0.3);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      }
      .card-hover {
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
      }
      .card-hover::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        transition: left 0.5s;
      }
      .card-hover:hover::before {
        left: 100%;
      }
      .card-hover:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
      }
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .animate-fadeInUp {
        animation: fadeInUp 0.6s ease-out forwards;
      }
      .section-title {
        position: relative;
        display: inline-block;
      }
      .section-title::after {
        content: "";
        position: absolute;
        bottom: -8px;
        left: 0;
        width: 60px;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2);
        border-radius: 2px;
        animation: expandWidth 0.6s ease-out;
      }
      @keyframes expandWidth {
        from {
          width: 0;
        }
        to {
          width: 60px;
        }
      }
      .nav-btn {
        padding: 12px 24px;
        margin: 0 8px;
        border-radius: 12px;
        font-weight: 600;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        cursor: pointer;
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
      }
      .nav-btn::before {
        content: "";
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.3);
        transform: translate(-50%, -50%);
        transition: width 0.6s, height 0.6s;
      }
      .nav-btn:hover::before {
        width: 300px;
        height: 300px;
      }
      .nav-btn:nth-child(1).active {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        box-shadow: 0 8px 24px rgba(102, 126, 234, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:nth-child(2).active {
        background: linear-gradient(135deg, #f093fb, #f5576c);
        color: white;
        box-shadow: 0 8px 24px rgba(240, 147, 251, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:nth-child(3).active {
        background: linear-gradient(135deg, #4facfe, #00f2fe);
        color: black;
        box-shadow: 0 8px 24px rgba(79, 172, 254, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:nth-child(4).active {
        background: linear-gradient(135deg, #43e97b, #38f9d7);
        color: black;
        box-shadow: 0 8px 24px rgba(67, 233, 123, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:nth-child(5).active {
        background: linear-gradient(135deg, #fa709a, #fee140);
        color: black;
        box-shadow: 0 8px 24px rgba(250, 112, 154, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:nth-child(6).active {
        background: linear-gradient(135deg, #30cfd0, #330867);
        color: white;
        box-shadow: 0 8px 24px rgba(48, 207, 208, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:nth-child(7).active {
        background: linear-gradient(135deg, #f6d365, #fda085);
        color: black;
        box-shadow: 0 8px 24px rgba(246, 211, 101, 0.5);
        transform: scale(1.05);
      }
      .nav-btn:not(.active) {
        background: rgba(255, 255, 255, 0.25);
        color: black;
        backdrop-filter: blur(10px);
      }
      .nav-btn:not(.active):hover {
        background: rgba(255, 255, 255, 0.4);
        transform: translateY(-3px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      }
      .section-content {
        display: none;
        animation: fadeInContent 0.5s ease-out;
      }
      @keyframes fadeInContent {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .section-content.active {
        display: block;
      }
      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        position: relative;
        overflow: hidden;
      }
      .stat-card::after {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: rotate 20s linear infinite;
      }
      @keyframes rotate {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }
      .stat-card p:first-child {
        color: rgba(255, 255, 255, 0.8);
      }
      .chart-wrapper {
        position: relative;
        height: 300px;
      }
      .chart-wrapper-large {
        position: relative;
        height: 400px;
      }
      .progress-bar {
        background: #e5e7eb;
        border-radius: 9999px;
        height: 8px;
        overflow: hidden;
      }
      .progress-fill {
        background: linear-gradient(90deg, #667eea, #764ba2);
        height: 100%;
        transition: width 0.5s;
      }
      .max-w-7xl {
        position: relative;
        z-index: 1;
      }
    </style>
  </head>
  <body class="min-h-screen p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
      <header
        class="glassmorphism rounded-2xl p-8 mb-8 shadow-2xl animate-fadeInUp"
      >
        <div class="text-center">
          <div class="inline-flex items-center gap-3 mb-3">
            <div
              class="w-14 h-14 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center"
            >
              <svg
                class="w-8 h-8 text-white"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
                ></path>
              </svg>
            </div>
            <h1
              class="text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent"
            >
              Dashboard Ph√¢n T√≠ch Kh·∫£o S√°t
            </h1>
          </div>
          <p class="text-gray-700 font-semibold text-lg mb-2">
            Ph√°t tri·ªÉn s·∫£n ph·∫©m du l·ªãch n√¥ng nghi·ªáp tr·∫£i nghi·ªám
          </p>
          <p class="text-gray-600">L√†ng hoa Sa ƒê√©c, t·ªânh ƒê·ªìng Th√°p</p>
          <p class="text-sm text-gray-500 mt-2">
            Kh√≥a lu·∫≠n t·ªët nghi·ªáp - Tr∆∞·ªùng ƒêH C√¥ng Nghi·ªáp TP.HCM
          </p>
        </div>
      </header>

      <div class="glassmorphism rounded-2xl p-6 mb-8 shadow-xl">
        <div class="flex flex-wrap justify-center gap-3">
          <button
            class="nav-btn active"
            onclick="showSection('overview', this)"
          >
            üìä T·ªïng quan
          </button>
          <button class="nav-btn" onclick="showSection('demographics', this)">
            üë• Nh√¢n kh·∫©u h·ªçc
          </button>
          <button class="nav-btn" onclick="showSection('behavior', this)">
            üéØ H√†nh vi du l·ªãch
          </button>
          <button class="nav-btn" onclick="showSection('satisfaction', this)">
            ‚≠ê M·ª©c ƒë·ªô h√†i l√≤ng
          </button>
          <button class="nav-btn" onclick="showSection('experience', this)">
            üå± Tr·∫£i nghi·ªám n√¥ng nghi·ªáp
          </button>
          <button class="nav-btn" onclick="showSection('future', this)">
            üöÄ D·ª± ƒë·ªãnh
          </button>
          <button class="nav-btn" onclick="showSection('feedback', this)">
            üó£Ô∏è C·∫£m nh·∫≠n & ƒê·ªÅ xu·∫•t
          </button>
        </div>
      </div>

      <div id="overview-section" class="section-content active">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          <div class="stat-card rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-white/80 text-sm font-medium mb-1">T·ªïng ph·∫£n h·ªìi</p>
            <p id="totalResponses" class="text-5xl font-bold">0</p>
          </div>

          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-gray-600 text-sm font-medium mb-1">
              Nh√≥m tu·ªïi ph·ªï bi·∫øn
            </p>
            <p id="popularAgeGroup" class="text-5xl font-bold text-gray-800">
              N/A
            </p>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-gray-600 text-sm font-medium mb-1">T·ª∑ l·ªá h√†i l√≤ng</p>
            <p id="satisfactionRate" class="text-5xl font-bold text-green-600">
              0%
            </p>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <p class="text-gray-600 text-sm font-medium mb-1">
              S·∫µn s√†ng quay l·∫°i
            </p>
            <p id="returnRate" class="text-5xl font-bold text-blue-600">0%</p>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Top 5 Ngh·ªÅ nghi·ªáp
            </h3>
            <div id="topOccupations" class="space-y-3"></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">Top 5 N∆°i ·ªü</h3>
            <div id="topLocations" class="space-y-3"></div>
          </div>
        </div>
      </div>

      <div id="demographics-section" class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <h3 class="section-title text-xl font-bold mb-6">Gi·ªõi t√≠nh</h3>
            <div class="chart-wrapper"><canvas id="genderChart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <h3 class="section-title text-xl font-bold mb-6">ƒê·ªô tu·ªïi</h3>
            <div class="chart-wrapper"><canvas id="ageChart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl card-hover">
            <h3 class="section-title text-xl font-bold mb-6">Ngh·ªÅ nghi·ªáp</h3>
            <div class="chart-wrapper">
              <canvas id="occupationChart"></canvas>
            </div>
          </div>
          <div
            class="glassmorphism rounded-2xl p-6 shadow-xl card-hover lg:col-span-2 xl:col-span-3"
          >
            <h3 class="section-title text-xl font-bold mb-6">N∆°i ·ªü hi·ªán t·∫°i</h3>
            <div class="chart-wrapper-large">
              <canvas id="locationChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div id="behavior-section" class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              S·ªë l·∫ßn ƒë·∫øn Sa ƒê√©c
            </h3>
            <div class="chart-wrapper">
              <canvas id="visitFrequencyChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">ƒêi c√πng ai?</h3>
            <div class="chart-wrapper">
              <canvas id="companionChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              H√¨nh th·ª©c du l·ªãch
            </h3>
            <div class="chart-wrapper">
              <canvas id="travelTypeChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Th·ªùi gian l∆∞u tr√∫
            </h3>
            <div class="chart-wrapper">
              <canvas id="stayDurationChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2">
            <h3 class="section-title text-xl font-bold mb-6">
              K√™nh bi·∫øt ƒë·∫øn L√†ng hoa
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="sourceChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2">
            <h3 class="section-title text-xl font-bold mb-6">
              M·ª•c ƒë√≠ch chuy·∫øn ƒëi
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="purposeChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2">
            <h3 class="section-title text-xl font-bold mb-6">
              Ho·∫°t ƒë·ªông ƒë√£ tham gia
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="activitiesChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div id="satisfaction-section" class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">S·ª± phong ph√∫ lo·∫°i hoa</h3>
            <div class="chart-wrapper"><canvas id="sat1Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">S·ª± hi·∫øu kh√°ch</h3>
            <div class="chart-wrapper"><canvas id="sat2Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">C·∫£nh quan & v·ªá sinh</h3>
            <div class="chart-wrapper"><canvas id="sat3Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">Th√°i ƒë·ªô nh√¢n vi√™n</h3>
            <div class="chart-wrapper"><canvas id="sat4Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">C∆° s·ªü h·∫° t·∫ßng</h3>
            <div class="chart-wrapper"><canvas id="sat5Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">N√©t ƒë·ªôc ƒë√°o</h3>
            <div class="chart-wrapper"><canvas id="sat6Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">Ch·∫•t l∆∞·ª£ng d·ªãch v·ª•</h3>
            <div class="chart-wrapper"><canvas id="sat7Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">Gi√° c·∫£ d·ªãch v·ª•</h3>
            <div class="chart-wrapper"><canvas id="sat8Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">S·ª± an to√†n</h3>
            <div class="chart-wrapper"><canvas id="sat9Chart"></canvas></div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="text-lg font-bold mb-4">ƒêa d·∫°ng ho·∫°t ƒë·ªông</h3>
            <div class="chart-wrapper"><canvas id="sat10Chart"></canvas></div>
          </div>
          <div
            class="glassmorphism rounded-2xl p-6 shadow-xl lg:col-span-2 xl:col-span-3"
          >
            <h3 class="text-lg font-bold mb-4">T√≠nh k·∫øt n·ªëi tour</h3>
            <div class="chart-wrapper"><canvas id="sat11Chart"></canvas></div>
          </div>
        </div>
      </div>

      <div id="experience-section" class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Quan t√¢m tr·∫£i nghi·ªám n√¥ng nghi·ªáp?
            </h3>
            <div class="chart-wrapper">
              <canvas id="expInterestChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              M·ª©c chi tr·∫£ mong mu·ªën
            </h3>
            <div class="chart-wrapper">
              <canvas id="priceRangeChart"></canvas>
            </div>
          </div>
        </div>

        <div class="glassmorphism rounded-2xl p-6 shadow-xl mb-6">
          <h3 class="section-title text-xl font-bold mb-6">
            Ho·∫°t ƒë·ªông tr·∫£i nghi·ªám mu·ªën ph√°t tri·ªÉn
          </h3>
          <div class="chart-wrapper-large">
            <canvas id="expActivitiesChart"></canvas>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Y·∫øu t·ªë thu h√∫t tham gia
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="attractionFactorsChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Y·∫øu t·ªë c·∫ßn c·∫£i thi·ªán
            </h3>
            <div class="chart-wrapper-large">
              <canvas id="improvementChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div id="future-section" class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Gi·ªõi thi·ªáu b·∫°n b√®?
            </h3>
            <div class="chart-wrapper">
              <canvas id="referralChart"></canvas>
            </div>
          </div>
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              D·ª± ƒë·ªãnh quay l·∫°i?
            </h3>
            <div class="chart-wrapper"><canvas id="returnChart"></canvas></div>
          </div>
        </div>
      </div>

      <div id="feedback-section" class="section-content">
        <div class="grid grid-cols-1 gap-6">
          <div class="glassmorphism rounded-2xl p-6 shadow-xl">
            <h3 class="section-title text-xl font-bold mb-6">
              Danh s√°ch C·∫£m nh·∫≠n & ƒê·ªÅ xu·∫•t
            </h3>
            <div
              id="feedbackListBox"
              class="space-y-4 max-h-[600px] overflow-y-auto pr-2"
            ></div>
          </div>
        </div>
      </div>

      <footer class="mt-8 text-center text-white/80 text-sm">
        <p>¬© 2025 Kh√≥a lu·∫≠n t·ªët nghi·ªáp - Tr∆∞·ªùng ƒêH C√¥ng Nghi·ªáp TP.HCM</p>
      </footer>
    </div>

    <script>
      const charts = {};
      const colors = [
        "#667eea",
        "#764ba2",
        "#f093fb",
        "#4facfe",
        "#43e97b",
        "#fa709a",
        "#fee140",
        "#30cfd0",
        "#a8edea",
        "#fed6e3",
      ];
      let globalData = [];
      let columnMapping = {};

      function showSection(section, element) {
        document
          .querySelectorAll(".section-content")
          .forEach((el) => el.classList.remove("active"));
        document
          .querySelectorAll(".nav-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document.getElementById(`${section}-section`).classList.add("active");
        element.classList.add("active");
      }

      document.addEventListener("DOMContentLoaded", loadData);

      async function loadData() {
        try {
          console.log("ƒêang t·∫£i d·ªØ li·ªáu t·ª´ data.json...");
          const response = await fetch("data.json");

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const rawData = await response.json();
          console.log("D·ªØ li·ªáu th√¥:", rawData);

          // Ki·ªÉm tra ƒë·ªãnh d·∫°ng
          if (Array.isArray(rawData)) {
            // ƒê·ªãnh d·∫°ng: [mapping, row1, row2, ...]
            console.log("‚úì ƒê·ªãnh d·∫°ng: Array");
            console.log("S·ªë d√≤ng:", rawData.length);

            if (rawData.length === 0) {
              throw new Error("File data.json l√† array r·ªóng!");
            }

            columnMapping = rawData[0];
            console.log("Column mapping:", columnMapping);

            globalData = rawData
              .slice(1)
              .map((row) => {
                const newRow = {};
                for (const key in row) {
                  if (columnMapping[key]) {
                    newRow[columnMapping[key]] = row[key];
                  }
                }
                return newRow;
              })
              .filter((row) =>
                Object.values(row).some(
                  (v) => v !== "" && v !== null && v !== undefined
                )
              );
          } else if (typeof rawData === "object" && rawData !== null) {
            // ƒê·ªãnh d·∫°ng: {A: "...", B: "...", ...} - ch·ªâ c√≥ mapping
            console.log("‚ö†Ô∏è ƒê·ªãnh d·∫°ng: Object (ch·ªâ c√≥ mapping, kh√¥ng c√≥ data)");
            columnMapping = rawData;
            globalData = [];

            alert(
              "‚ö†Ô∏è C·∫¢NH B√ÅO: File data.json ch·ªâ ch·ª©a column mapping!\n\n" +
                "ƒê·ªãnh d·∫°ng hi·ªán t·∫°i:\n" +
                '{"A": "...", "B": "...", ...}\n\n' +
                "ƒê·ªãnh d·∫°ng ƒë√∫ng ph·∫£i l√†:\n" +
                "[\n" +
                ' ¬†{"A": "D·∫•u th·ªùi gian", "B": "1. Gi·ªõi t√≠nh:", ...},\n' +
                ' ¬†{"A": "2024-01-01", "B": "Nam", ...},\n' +
                ' ¬†{"A": "2024-01-02", "B": "N·ªØ", ...}\n' +
                "]\n\n" +
                "Dashboard s·∫Ω hi·ªÉn th·ªã demo data ƒë·ªÉ b·∫°n xem giao di·ªán."
            );

            // T·∫°o demo data ƒë·ªÉ hi·ªÉn th·ªã giao di·ªán
            globalData = generateDemoData();
          } else {
            throw new Error("ƒê·ªãnh d·∫°ng data.json kh√¥ng h·ª£p l·ªá!");
          }

          console.log("D·ªØ li·ªáu ƒë√£ x·ª≠ l√Ω:", globalData);
          console.log("S·ªë b·∫£n ghi h·ª£p l·ªá:", globalData.length);

          if (globalData.length === 0) {
            alert(
              "‚ö†Ô∏è Kh√¥ng c√≥ d·ªØ li·ªáu!\n\n" +
                "File data.json c·∫ßn c√≥ ƒë·ªãnh d·∫°ng:\n" +
                "[\n" +
                ' ¬†{"A": "D·∫•u th·ªùi gian", "B": "1. Gi·ªõi t√≠nh:", ...}, ¬†// Row 0: Column mapping\n' +
                ' ¬†{"A": "2024-01-01 10:00", "B": "Nam", "C": "18-25", ...}, ¬†// Row 1: Data\n' +
                ' ¬†{"A": "2024-01-01 11:00", "B": "N·ªØ", "C": "26-35", ...} ¬† // Row 2: Data\n' +
                "]\n\n" +
                "Hi·ªÉn th·ªã demo data..."
            );
            globalData = generateDemoData();
          }

          processAllData();
          console.log("‚úÖ T·∫£i d·ªØ li·ªáu th√†nh c√¥ng!");
        } catch (error) {
          console.error("‚ùå L·ªói chi ti·∫øt:", error);
          alert(
            `Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu!\n\nL·ªói: ${error.message}\n\n` +
              `Vui l√≤ng:\n` +
              `1. Ki·ªÉm tra file data.json c√≥ c√πng th∆∞ m·ª•c v·ªõi file HTML\n` +
              `2. ƒê·∫£m b·∫£o ƒë·ªãnh d·∫°ng l√† Array: [mapping, data1, data2, ...]\n` +
              `3. M·ªü Console (F12) ƒë·ªÉ xem chi ti·∫øt\n\n` +
              `Hi·ªÉn th·ªã demo data...`
          );

          // Load demo data khi c√≥ l·ªói
          columnMapping = {
            A: "D·∫•u th·ªùi gian",
            B: "1. Gi·ªõi t√≠nh:",
            C: "2. ƒê·ªô tu·ªïi:",
            D: "3. N∆°i ·ªü hi·ªán t·∫°i:",
            E: "4. Ngh·ªÅ nghi·ªáp c·ªßa Anh/Ch·ªã:",
            // Th√™m c√°c key kh√°c n·∫øu demo data c·∫ßn
            F: "5. Anh/Ch·ªã ƒë√£ ƒë·∫øn L√†ng hoa Sa ƒê√©c bao nhi√™u l·∫ßn?",
            G: "6. Anh/Ch·ªã bi·∫øt ƒë·∫øn L√†ng hoa Sa ƒê√©c th√¥ng qua k√™nh th√¥ng tin n√†o? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë√°p √°n)",
            H: "7. Anh/Ch·ªã ƒëi du l·ªãch v·ªõi ai?",
            I: "8. M·ª•c ƒë√≠ch c·ªßa Anh/Ch·ªã khi ƒë·∫øn L√†ng hoa Sa ƒê√©c l√† g√¨? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë√°p √°n)",
            J: "9. Anh/Ch·ªã ƒëi du l·ªãch theo h√¨nh th·ª©c n√†o? ",
            K: "10. Th·ªùi gian l∆∞u tr√∫ c·ªßa Anh/Ch·ªã t·∫°i Sa ƒê√©c l√† bao l√¢u? ",
            L: "11. Anh/Ch·ªã ƒë√£ tham gia nh·ªØng ho·∫°t ƒë·ªông n√†o t·∫°i Sa ƒê√©c? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë√°p √°n)",
            M: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± phong ph√∫ c·ªßa c√°c lo·∫°i hoa]",
            N: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± hi·∫øu kh√°ch c·ªßa ng∆∞·ªùi d√¢n ƒë·ªãa ph∆∞∆°ng]",
            O: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [C·∫£nh quan, v·ªá sinh m√¥i tr∆∞·ªùng]",
            P: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [Th√°i ƒë·ªô ph·ª•c v·ª• c·ªßa nh√¢n vi√™n]",
            Q: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [C∆° s·ªü h·∫° t·∫ßng]",
            R: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [N√©t ri√™ng bi·ªát/ƒë·ªôc ƒë√°o c·ªßa ƒëi·ªÉm ƒë·∫øn]",
            S: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [Ch·∫•t l∆∞·ª£ng d·ªãch v·ª•]",
            T: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [Gi√° c·∫£ d·ªãch v·ª•]",
            U: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± an to√†n trong qu√° tr√¨nh tr·∫£i nghi·ªám]",
            V: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± ƒëa d·∫°ng c·ªßa c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám]",
            W: "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [T√≠nh k·∫øt n·ªëi gi·ªØa c√°c ƒëi·ªÉm tham quan trong khu v·ª±c Sa ƒê√©c (li√™n k·∫øt tour, tuy·∫øn, c∆° s·ªü l∆∞u tr√∫, ·∫©m th·ª±c)]",
            X: '13. Ngo√†i tham quan v√† ch·ª•p ·∫£nh, Anh/Ch·ªã c√≥ quan t√¢m ƒë·∫øn c√°c ho·∫°t ƒë·ªông mang t√≠nh "tr·∫£i nghi·ªám" n√¥ng nghi·ªáp kh√¥ng?',
            Y: "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[Tour tham quan v∆∞·ªùn hoa b·∫±ng xe ƒë·∫°p/xe ƒëi·ªán c√≥ h∆∞·ªõng d·∫´n vi√™n ƒë·ªãa ph∆∞∆°ng]",
            Z: '14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[Tr·∫£i nghi·ªám "M·ªôt ng√†y l√†m n√¥ng d√¢n" (tr·ªçn g√≥i t·ª´ tr·ªìng, chƒÉm s√≥c, thu ho·∫°ch)]',
            AA: "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[Workshop c·∫Øm hoa/t·∫°o h√¨nh bonsai mini (do ngh·ªá nh√¢n h∆∞·ªõng d·∫´n)]",
            AB: "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[L·ªõp h·ªçc n·∫•u ƒÉn/l√†m b√°nh s·ª≠ d·ª•ng nguy√™n li·ªáu hoa (v√≠ d·ª•: b√°nh k·∫πp hoa h·ªìng, g·ªèi hoa...)]",
            AC: "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[L·ªõp h·ªçc/Workshop l√†m s·∫£n ph·∫©m th·ªß c√¥ng t·ª´ hoa (l√†m n·∫øn th∆°m, tr√† hoa, x√† ph√≤ng, tranh hoa)]",
            AD: "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[C√°c ho·∫°t ƒë·ªông g·∫Øn li·ªÅn vƒÉn h√≥a s√¥ng n∆∞·ªõc (t√°t m∆∞∆°ng, b·∫Øt c√° t·∫°i v∆∞·ªùn)]",
            AE: "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[L∆∞u tr√∫ t·∫°i nh√† d√¢n (Homestay) trong l√†ng hoa ƒë·ªÉ tr·∫£i nghi·ªám cu·ªôc s·ªëng c√πng n√¥ng d√¢n]",
            AF: "15. Anh/Ch·ªã s·∫µn s√†ng chi tr·∫£ bao nhi√™u/ng∆∞·ªùi cho m·ªôt g√≥i ho·∫°t ƒë·ªông tr·∫£i nghi·ªám (kho·∫£ng 2-3 ti·∫øng, bao g·ªìm h∆∞·ªõng d·∫´n v√† th√†nh ph·∫©m mang v·ªÅ)?",
            AG: "16. Theo Anh/Ch·ªã, nh·ªØng y·∫øu t·ªë n√†o l√† quan tr·ªçng nh·∫•t ƒë·ªÉ thu h√∫t kh√°ch tham gia du l·ªãch tr·∫£i nghi·ªám? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ph∆∞∆°ng √°n)",
            AH: "C√¢u 17: Theo Anh/Ch·ªã, nh·ªØng y·∫øu t·ªë c·∫ßn c·∫£i thi·ªán ƒë·ªÉ c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp h·∫•p d·∫´n h∆°n? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ph∆∞∆°ng √°n) ",
            AI: "C√¢u 18: Anh/Ch·ªã c√≥ s·∫µn l√≤ng gi·ªõi thi·ªáu b·∫°n b√®/ng∆∞·ªùi th√¢n ƒë·∫øn L√†ng hoa Sa ƒê√©c ƒë·ªÉ tham gia du l·ªãch n√¥ng nghi·ªáp tr·∫£i nghi·ªám kh√¥ng? ",
            AJ: "C√¢u 19. Anh/Ch·ªã c√≥ d·ª± ƒë·ªãnh quay l·∫°i L√†ng hoa Sa ƒê√©c trong th·ªùi gian t·ªõi kh√¥ng?‚Äù",
            AK: "20. Anh/Ch·ªã c·∫£m nh·∫≠n nh∆∞ th·∫ø n√†o v·ªÅ chuy·∫øn ƒëi L√†ng hoa Sa ƒê√©c l·∫ßn n√†y?",
            AL: "21. Anh/Ch·ªã c√≥ ƒë·ªÅ xu·∫•t g√¨ ƒë·ªÉ L√†ng hoa Sa ƒê√©c ph√°t tri·ªÉn c√°c s·∫£n ph·∫©m du l·ªãch tr·∫£i nghi·ªám h·∫•p d·∫´n h∆°n kh√¥ng?",
          };
          globalData = generateDemoData();
          processAllData();
        }
      }

      function generateDemoData() {
        // T·∫°o 50 m·∫´u d·ªØ li·ªáu demo
        const genders = ["Nam", "N·ªØ"];
        const ages = ["18-25", "26-35", "36-45", "46-55", "Tr√™n 55"];
        const locations = [
          "TP.HCM",
          "H√† N·ªôi",
          "ƒê·ªìng Th√°p",
          "C·∫ßn Th∆°",
          "An Giang",
          "Vƒ©nh Long",
        ];
        const occupations = [
          "Sinh vi√™n",
          "Nh√¢n vi√™n vƒÉn ph√≤ng",
          "Kinh doanh",
          "Gi√°o vi√™n",
          "T·ª± do",
          "H∆∞u tr√≠",
        ];
        const visits = ["L·∫ßn ƒë·∫ßu", "2-3 l·∫ßn", "4-5 l·∫ßn", "Tr√™n 5 l·∫ßn"];
        const companions = [
          "M·ªôt m√¨nh",
          "Gia ƒë√¨nh",
          "B·∫°n b√®",
          "ƒê·ªìng nghi·ªáp",
          "Tour du l·ªãch",
        ];
        const travelTypes = [
          "T·ª± t√∫c",
          "Tour tr·ªçn g√≥i",
          "Tour tr·ªçn g√≥i",
          "K·∫øt h·ª£p",
        ];
        const durations = [
          "N·ª≠a ng√†y",
          "1 ng√†y",
          "2 ng√†y 1 ƒë√™m",
          "3 ng√†y 2 ƒë√™m",
        ];
        const satisfactions = [
          "R·∫•t h√†i l√≤ng",
          "H√†i l√≤ng",
          "B√¨nh th∆∞·ªùng",
          "Kh√¥ng h√†i l√≤ng",
        ];
        const interests = [
          "R·∫•t quan t√¢m",
          "Quan t√¢m",
          "B√¨nh th∆∞·ªùng",
          "Kh√¥ng quan t√¢m",
        ];
        const prices = [
          "100.000 - 200.000 VNƒê",
          "200.000 - 300.000 VNƒê",
          "300.000 - 500.000 VNƒê",
          "Tr√™n 500.000 VNƒê",
        ];
        const yesNo = ["C√≥", "Kh√¥ng"];

        const demoData = [];
        for (let i = 0; i < 50; i++) {
          demoData.push({
            "D·∫•u th·ªùi gian": `2024-11-${String((i % 30) + 1).padStart(
              2,
              "0"
            )} ${String(Math.floor(Math.random() * 24)).padStart(
              2,
              "0"
            )}:${String(Math.floor(Math.random() * 60)).padStart(2, "0")}`,
            "1. Gi·ªõi t√≠nh:":
              genders[Math.floor(Math.random() * genders.length)],
            "2. ƒê·ªô tu·ªïi:": ages[Math.floor(Math.random() * ages.length)],
            "3. N∆°i ·ªü hi·ªán t·∫°i:":
              locations[Math.floor(Math.random() * locations.length)],
            "4. Ngh·ªÅ nghi·ªáp c·ªßa Anh/Ch·ªã:":
              occupations[Math.floor(Math.random() * occupations.length)],
            "5. Anh/Ch·ªã ƒë√£ ƒë·∫øn L√†ng hoa Sa ƒê√©c bao nhi√™u l·∫ßn?":
              visits[Math.floor(Math.random() * visits.length)],
            "6. Anh/Ch·ªã bi·∫øt ƒë·∫øn L√†ng hoa Sa ƒê√©c th√¥ng qua k√™nh th√¥ng tin n√†o? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë√°p √°n)":
              "M·∫°ng x√£ h·ªôi, B·∫°n b√®/ng∆∞·ªùi th√¢n gi·ªõi thi·ªáu",
            "7. Anh/Ch·ªã ƒëi du l·ªãch v·ªõi ai?":
              companions[Math.floor(Math.random() * companions.length)],
            "8. M·ª•c ƒë√≠ch c·ªßa Anh/Ch·ªã khi ƒë·∫øn L√†ng hoa Sa ƒê√©c l√† g√¨? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë√°p √°n)":
              "Du l·ªãch ngh·ªâ d∆∞·ª°ng, Ch·ª•p ·∫£nh",
            "9. Anh/Ch·ªã ƒëi du l·ªãch theo h√¨nh th·ª©c n√†o? ":
              travelTypes[Math.floor(Math.random() * travelTypes.length)],
            "10. Th·ªùi gian l∆∞u tr√∫ c·ªßa Anh/Ch·ªã t·∫°i Sa ƒê√©c l√† bao l√¢u? ":
              durations[Math.floor(Math.random() * durations.length)],
            "11. Anh/Ch·ªã ƒë√£ tham gia nh·ªØng ho·∫°t ƒë·ªông n√†o t·∫°i Sa ƒê√©c? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ƒë√°p √°n)":
              "Tham quan v∆∞·ªùn hoa, Ch·ª•p ·∫£nh, Mua hoa",
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± phong ph√∫ c·ªßa c√°c lo·∫°i hoa]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± hi·∫øu kh√°ch c·ªßa ng∆∞·ªùi d√¢n ƒë·ªãa ph∆∞∆°ng]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [C·∫£nh quan, v·ªá sinh m√¥i tr∆∞·ªùng]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [Th√°i ƒë·ªô ph·ª•c v·ª• c·ªßa nh√¢n vi√™n]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [C∆° s·ªü h·∫° t·∫ßng]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [N√©t ri√™ng bi·ªát/ƒë·ªôc ƒë√°o c·ªßa ƒëi·ªÉm ƒë·∫øn]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [Ch·∫•t l∆∞·ª£ng d·ªãch v·ª•]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [Gi√° c·∫£ d·ªãch v·ª•]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± an to√†n trong qu√° tr√¨nh tr·∫£i nghi·ªám]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [S·ª± ƒëa d·∫°ng c·ªßa c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            "12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√° m·ª©c ƒë·ªô h√†i l√≤ng v·ªÅ c√°c y·∫øu t·ªë sau: [T√≠nh k·∫øt n·ªëi gi·ªØa c√°c ƒëi·ªÉm tham quan trong khu v·ª±c Sa ƒê√©c (li√™n k·∫øt tour, tuy·∫øn, c∆° s·ªü l∆∞u tr√∫, ·∫©m th·ª±c)]":
              satisfactions[Math.floor(Math.random() * satisfactions.length)],
            '13. Ngo√†i tham quan v√† ch·ª•p ·∫£nh, Anh/Ch·ªã c√≥ quan t√¢m ƒë·∫øn c√°c ho·∫°t ƒë·ªông mang t√≠nh "tr·∫£i nghi·ªám" n√¥ng nghi·ªáp kh√¥ng?':
              interests[Math.floor(Math.random() * 2)],
            "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[Tour tham quan v∆∞·ªùn hoa b·∫±ng xe ƒë·∫°p/xe ƒëi·ªán c√≥ h∆∞·ªõng d·∫´n vi√™n ƒë·ªãa ph∆∞∆°ng]":
              interests[Math.floor(Math.random() * interests.length)],
            '14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[Tr·∫£i nghi·ªám "M·ªôt ng√†y l√†m n√¥ng d√¢n" (tr·ªçn g√≥i t·ª´ tr·ªìng, chƒÉm s√≥c, thu ho·∫°ch)]':
              interests[Math.floor(Math.random() * interests.length)],
            "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[Workshop c·∫Øm hoa/t·∫°o h√¨nh bonsai mini (do ngh·ªá nh√¢n h∆∞·ªõng d·∫´n)]":
              interests[Math.floor(Math.random() * interests.length)],
            "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[L·ªõp h·ªçc n·∫•u ƒÉn/l√†m b√°nh s·ª≠ d·ª•ng nguy√™n li·ªáu hoa (v√≠ d·ª•: b√°nh k·∫πp hoa h·ªìng, g·ªèi hoa...)]":
              interests[Math.floor(Math.random() * interests.length)],
            "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[L·ªõp h·ªçc/Workshop l√†m s·∫£n ph·∫©m th·ªß c√¥ng t·ª´ hoa (l√†m n·∫øn th∆°m, tr√† hoa, x√† ph√≤ng, tranh hoa)]":
              interests[Math.floor(Math.random() * interests.length)],
            "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[C√°c ho·∫°t ƒë·ªông g·∫Øn li·ªÅn vƒÉn h√≥a s√¥ng n∆∞·ªõc (t√°t m∆∞∆°ng, b·∫Øt c√° t·∫°i v∆∞·ªùn)]":
              interests[Math.floor(Math.random() * interests.length)],
            "14. Anh/Ch·ªã quan t√¢m ƒë·∫øn vi·ªác ph√°t tri·ªÉn th√™m c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp n√†o sau ƒë√¢y t·∫°i L√†ng hoa Sa ƒê√©c? ¬†[L∆∞u tr√∫ t·∫°i nh√† d√¢n (Homestay) trong l√†ng hoa ƒë·ªÉ tr·∫£i nghi·ªám cu·ªôc s·ªëng c√πng n√¥ng d√¢n]":
              interests[Math.floor(Math.random() * interests.length)],
            "15. Anh/Ch·ªã s·∫µn s√†ng chi tr·∫£ bao nhi√™u/ng∆∞·ªùi cho m·ªôt g√≥i ho·∫°t ƒë·ªông tr·∫£i nghi·ªám (kho·∫£ng 2-3 ti·∫øng, bao g·ªìm h∆∞·ªõng d·∫´n v√† th√†nh ph·∫©m mang v·ªÅ)?":
              prices[Math.floor(Math.random() * prices.length)],
            "16. Theo Anh/Ch·ªã, nh·ªØng y·∫øu t·ªë n√†o l√† quan tr·ªçng nh·∫•t ƒë·ªÉ thu h√∫t kh√°ch tham gia du l·ªãch tr·∫£i nghi·ªám? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ph∆∞∆°ng √°n)":
              "T√≠nh ƒë·ªôc ƒë√°o c·ªßa ho·∫°t ƒë·ªông, Gi√° c·∫£ h·ª£p l√Ω",
            "C√¢u 17: Theo Anh/Ch·ªã, nh·ªØng y·∫øu t·ªë c·∫ßn c·∫£i thi·ªán ƒë·ªÉ c√°c ho·∫°t ƒë·ªông tr·∫£i nghi·ªám n√¥ng nghi·ªáp h·∫•p d·∫´n h∆°n? (C√≥ th·ªÉ ch·ªçn nhi·ªÅu ph∆∞∆°ng √°n) ":
              "C·∫£i thi·ªán c∆° s·ªü v·∫≠t ch·∫•t, TƒÉng c∆∞·ªùng qu·∫£ng b√°",
            "C√¢u 18: Anh/Ch·ªã c√≥ s·∫µn l√≤ng gi·ªõi thi·ªáu b·∫°n b√®/ng∆∞·ªùi th√¢n ƒë·∫øn L√†ng hoa Sa ƒê√©c ƒë·ªÉ tham gia du l·ªãch n√¥ng nghi·ªáp tr·∫£i nghi·ªám kh√¥ng? ":
              yesNo[Math.floor(Math.random() * yesNo.length)],
            // *** ƒê√ÇY L√Ä CH·ªñ FIX ***
            "C√¢u 19. Anh/Ch·ªã c√≥ d·ª± ƒë·ªãnh quay l·∫°i L√†ng hoa Sa ƒê√©c trong th·ªùi gian t·ªõi kh√¥ng?‚Äù":
              yesNo[Math.floor(Math.random() * yesNo.length)],
            "20. Anh/Ch·ªã c·∫£m nh·∫≠n nh∆∞ th·∫ø n√†o v·ªÅ chuy·∫øn ƒëi L√†ng hoa Sa ƒê√©c l·∫ßn n√†y?":
              "R·∫•t th√≠ch! Hoa ƒë·∫πp, kh√¥ng kh√≠ trong l√†nh.",
            "21. Anh/Ch·ªã c√≥ ƒë·ªÅ xu·∫•t g√¨ ƒë·ªÉ L√†ng hoa Sa ƒê√©c ph√°t tri·ªÉn c√°c s·∫£n ph·∫©m du l·ªãch tr·∫£i nghi·ªám h·∫•p d·∫´n h∆°n kh√¥ng?":
              "N√™n c√≥ th√™m c√°c ho·∫°t ƒë·ªông t∆∞∆°ng t√°c.",
          });
        }

        console.log("‚úì ƒê√£ t·∫°o 50 m·∫´u demo data");
        return demoData;
      }

      function processAllData() {
        const d = globalData;

        document.getElementById("totalResponses").textContent = d.length;

        if (d.length === 0) {
          console.warn("Kh√¥ng c√≥ d·ªØ li·ªáu kh·∫£o s√°t ƒë·ªÉ x·ª≠ l√Ω.");
          document.getElementById("popularAgeGroup").textContent = "N/A";
          return;
        }

        // Stats
        const ageCounts = {};
        d.forEach((row) => {
          const ageGroup = row["2. ƒê·ªô tu·ªïi:"];
          if (ageGroup) {
            ageCounts[ageGroup] = (ageCounts[ageGroup] || 0) + 1;
          }
        });

        let popularAgeGroup = "N/A";
        let maxCount = 0;
        for (const ageGroup in ageCounts) {
          if (ageCounts[ageGroup] > maxCount) {
            maxCount = ageCounts[ageGroup];
            popularAgeGroup = ageGroup;
          }
        }
        document.getElementById("popularAgeGroup").textContent =
          popularAgeGroup;

        // Satisfaction rate
        const satKeys = Object.keys(d[0]).filter((k) =>
          k.includes("12. Anh/Ch·ªã vui l√≤ng ƒë√°nh gi√°")
        );
        let satisfiedTotal = 0,
          satCount = 0;
        d.forEach((row) => {
          satKeys.forEach((key) => {
            const val = row[key];
            if (val) {
              satCount++;
              if (val === "R·∫•t h√†i l√≤ng" || val === "H√†i l√≤ng")
                satisfiedTotal++;
            }
          });
        });
        const satRate =
          satCount > 0 ? ((satisfiedTotal / satCount) * 100).toFixed(1) : "0";
        document.getElementById("satisfactionRate").textContent = satRate + "%";

        // Return rate
        // *** ƒê√ÇY L√Ä CH·ªñ FIX ***
        const returnKey =
          "C√¢u 19. Anh/Ch·ªã c√≥ d·ª± ƒë·ªãnh quay l·∫°i L√†ng hoa Sa ƒê√©c trong th·ªùi gian t·ªõi kh√¥ng?‚Äù"; // Ph·∫£i d√πng smart quote "‚Äù"
        const returnYes = d.filter((row) => {
          const val = row[returnKey];
          return (
            val &&
            (val.toLowerCase().includes("c√≥") ||
              val.toLowerCase().includes("ch·∫Øc ch·∫Øn"))
          );
        }).length;
        const returnRate = ((returnYes / d.length) * 100).toFixed(1);
        document.getElementById("returnRate").textContent = returnRate + "%";

        // Top occupations and locations
        renderTopList(d, "4. Ngh·ªÅ nghi·ªáp c·ªßa Anh/Ch·ªã:", "topOccupations");
        renderTopList(d, "3. N∆°i ·ªü hi·ªán t·∫°i:", "topLocations");

        // Demographics
        renderPieChart(d, "B", "genderChart", "doughnut");
        renderBarChart(d, "C", "ageChart");
        renderBarChart(d, "E", "occupationChart", true);
        renderBarChart(d, "D", "locationChart", true);

        // Behavior
        renderPieChart(d, "F", "visitFrequencyChart", "pie");
        renderPieChart(d, "H", "companionChart", "doughnut");
        renderPieChart(d, "J", "travelTypeChart", "polarArea");
        renderBarChart(d, "K", "stayDurationChart");
        renderMultiChart(d, "G", "sourceChart");
        renderMultiChart(d, "I", "purposeChart");
        renderMultiChart(d, "L", "activitiesChart");

        // Satisfaction (11 charts)
        const satOrder = [
          "R·∫•t h√†i l√≤ng",
          "H√†i l√≤ng",
          "B√¨nh th∆∞·ªùng",
          "Kh√¥ng h√†i l√≤ng",
          "R·∫•t kh√¥ng h√†i l√≤ng",
        ];
        renderOrderedChart(d, "M", "sat1Chart", satOrder);
        renderOrderedChart(d, "N", "sat2Chart", satOrder);
        renderOrderedChart(d, "O", "sat3Chart", satOrder);
        renderOrderedChart(d, "P", "sat4Chart", satOrder);
        renderOrderedChart(d, "Q", "sat5Chart", satOrder);
        renderOrderedChart(d, "R", "sat6Chart", satOrder);
        renderOrderedChart(d, "S", "sat7Chart", satOrder);
        renderOrderedChart(d, "T", "sat8Chart", satOrder);
        renderOrderedChart(d, "U", "sat9Chart", satOrder);
        renderOrderedChart(d, "V", "sat10Chart", satOrder);
        renderOrderedChart(d, "W", "sat11Chart", satOrder);

        // Experience
        renderPieChart(d, "X", "expInterestChart", "doughnut");
        renderBarChart(d, "AF", "priceRangeChart");

        const expCols = ["Y", "Z", "AA", "AB", "AC", "AD", "AE"];
        renderMultiColChart(d, expCols, "expActivitiesChart");

        renderMultiChart(d, "AG", "attractionFactorsChart");
        renderMultiChart(d, "AH", "improvementChart");

        // Future
        renderPieChart(d, "AI", "referralChart", "doughnut");
        renderPieChart(d, "AJ", "returnChart", "doughnut");

        // Feedback
        renderFeedbackList(d, "AK", "AL", "feedbackListBox");
      }

      function getColumnByLetter(letter) {
        // Ki·ªÉm tra xem mapping ƒë√£ ƒë∆∞·ª£c t·∫£i ch∆∞a
        if (Object.keys(columnMapping).length === 0) {
          console.error("Column mapping ch∆∞a ƒë∆∞·ª£c t·∫£i!");
          return null; // Tr·∫£ v·ªÅ null n·∫øu mapping ch∆∞a s·∫µn s√†ng
        }
        // Tr·∫£ v·ªÅ t√™n c·ªôt ƒë·∫ßy ƒë·ªß t·ª´ mapping
        const colName = columnMapping[letter];
        if (!colName) {
          console.warn(`Kh√¥ng t√¨m th·∫•y mapping cho ch·ªØ c√°i: ${letter}`);
          return null;
        }
        return colName;
      }

      function renderTopList(data, colName, elementId, top = 5) {
        if (!colName) return; // Th√™m ki·ªÉm tra
        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) counts[val] = (counts[val] || 0) + 1;
        });
        const sorted = Object.entries(counts)
          .sort(([, a], [, b]) => b - a)
          .slice(0, top);
        const max = sorted[0] ? sorted[0][1] : 1;

        const html = sorted
          .map(
            ([label, count], i) => `
                <div class="mb-2">
                    <div class="flex justify-between mb-1">
                        <span class="font-medium text-sm text-gray-800">${label}</span>
                        <span class="text-sm text-gray-600">${count} ng∆∞·ªùi</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${
                          (count / max) * 100
                        }%; background: ${colors[i % colors.length]}"></div>
                    </div>
                </div>
            `
          )
          .join("");
        document.getElementById(elementId).innerHTML = html;
      }

      function renderPieChart(data, colLetter, canvasId, type) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(`(Pie) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`);
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) counts[val] = (counts[val] || 0) + 1;
        });

        createChart(
          canvasId,
          type,
          Object.keys(counts),
          Object.values(counts),
          true
        );
      }

      function renderBarChart(data, colLetter, canvasId, sort = false) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(`(Bar) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`);
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) counts[val] = (counts[val] || 0) + 1;
        });

        let entries = Object.entries(counts);
        if (sort) entries = entries.sort(([, a], [, b]) => b - a);

        createChart(
          canvasId,
          "bar",
          entries.map((e) => e[0]),
          entries.map((e) => e[1]),
          false
        );
      }

      function renderOrderedChart(data, colLetter, canvasId, order) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(
            `(Ordered) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`
          );
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) counts[val] = (counts[val] || 0) + 1;
        });

        const labels = order;
        const values = order.map((label) => counts[label] || 0);

        createChart(canvasId, "bar", labels, values, false);
      }

      function renderMultiChart(data, colLetter, canvasId) {
        const colName = getColumnByLetter(colLetter);
        if (!colName) {
          console.error(`(Multi) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${colLetter}`);
          return;
        }

        const counts = {};
        data.forEach((row) => {
          const val = row[colName];
          if (val) {
            val
              .split(",")
              .map((v) => v.trim())
              .forEach((item) => {
                if (item) counts[item] = (counts[item] || 0) + 1;
              });
          }
        });

        const sorted = Object.entries(counts).sort(([, a], [, b]) => b - a);
        createChart(
          canvasId,
          "bar",
          sorted.map((e) => e[0]),
          sorted.map((e) => e[1]),
          false,
          true
        );
      }

      function renderMultiColChart(data, colLetters, canvasId) {
        const counts = {};

        colLetters.forEach((letter) => {
          const colName = getColumnByLetter(letter);
          if (!colName) {
            console.error(
              `(MultiCol) Kh√¥ng t√¨m th·∫•y c·ªôt cho ch·ªØ c√°i: ${letter}`
            );
            return;
          }

          data.forEach((row) => {
            const val = row[colName];
            if (
              val &&
              (val === "R·∫•t quan t√¢m" ||
                val === "Quan t√¢m" ||
                val.toLowerCase().includes("c√≥"))
            ) {
              const activityMatch = colName.match(/\[(.*?)\]/);
              if (activityMatch) {
                const activity = activityMatch[1];
                counts[activity] = (counts[activity] || 0) + 1;
              }
            }
          });
        });

        const sorted = Object.entries(counts).sort(([, a], [, b]) => b - a);
        createChart(
          canvasId,
          "bar",
          sorted.map((e) => e[0]),
          sorted.map((e) => e[1]),
          false,
          true
        );
      }

      function renderFeedbackList(
        data,
        feelingColLetter,
        suggestionColLetter,
        elementId
      ) {
        const feelingCol = getColumnByLetter(feelingColLetter);
        const suggestionCol = getColumnByLetter(suggestionColLetter);
        const container = document.getElementById(elementId);

        if (!feelingCol || !suggestionCol || !container) {
          console.error(
            "Kh√¥ng t√¨m th·∫•y c·ªôt ho·∫∑c element cho danh s√°ch feedback."
          );
          return;
        }

        const feedbackItems = data
          .map((row, i) => {
            const feeling = row[feelingCol] || null;
            const suggestion = row[suggestionCol] || null;

            if (feeling || (suggestion && suggestion.trim().length > 5)) {
              return `
                <div class="p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border-l-4 border-purple-500 shadow-sm">
                    <div class="flex items-start gap-3 mb-3">
                        <span class="flex-shrink-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-bold text-sm" title="C·∫£m nh·∫≠n">üòä</span>
                        <div class="text-gray-700 text-sm leading-relaxed w-full">
                            <strong class="text-gray-900">C·∫£m nh·∫≠n chuy·∫øn ƒëi:</strong>
                            <p class="mt-1">${
                              feeling || "<em>(Kh√¥ng c√≥)</em>"
                            }</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3">
                        <span class="flex-shrink-0 w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center font-bold text-sm" title="ƒê·ªÅ xu·∫•t">üí°</span>
                        <div class="text-gray-700 text-sm leading-relaxed w-full">
                            <strong class="text-gray-900">ƒê·ªÅ xu·∫•t:</strong>
                            <p class="mt-1">${
                              suggestion || "<em>(Kh√¥ng c√≥)</em>"
                            }</p>
                        </div>
                    </div>
                </div>
              `;
            }
            return "";
          })
          .join("");

        container.innerHTML =
          feedbackItems.length > 0
            ? feedbackItems
            : '<p class="text-gray-500 text-center py-8">Ch∆∞a c√≥ c·∫£m nh·∫≠n ho·∫∑c ƒë·ªÅ xu·∫•t n√†o.</p>';
      }

      function createChart(
        canvasId,
        type,
        labels,
        data,
        isPie = false,
        horizontal = false
      ) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) {
          console.error(`Kh√¥ng t√¨m th·∫•y canvas: ${canvasId}`);
          return;
        }

        if (charts[canvasId]) charts[canvasId].destroy();

        const ctx = canvas.getContext("2d");

        const config = {
          type: horizontal ? "bar" : type,
          data: {
            labels: labels,
            datasets: [
              {
                label: "S·ªë l∆∞·ª£ng",
                data: data,
                backgroundColor: isPie
                  ? labels.map((_, i) => colors[i % colors.length])
                  : labels.map((_, i) => colors[i % colors.length] + "90"),
                borderColor: isPie
                  ? "#fff"
                  : labels.map((_, i) => colors[i % colors.length]),
                borderWidth: isPie ? 2 : 2,
                borderRadius: isPie ? 0 : 8,
                hoverOffset: isPie ? 15 : 0,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: isPie,
                position: "bottom",
                labels: {
                  padding: 12,
                  font: { size: 11, weight: "500" },
                  usePointStyle: true,
                  boxWidth: 12,
                  color: "#333",
                },
              },
              tooltip: {
                backgroundColor: "rgba(0, 0, 0, 0.85)",
                padding: 12,
                titleFont: { size: 13, weight: "bold" },
                bodyFont: { size: 12 },
                cornerRadius: 8,
                displayColors: true,
              },
            },
            scales: isPie
              ? {}
              : {
                  x: {
                    display: true,
                    grid: { display: false },
                    ticks: {
                      font: { size: 10 },
                      autoSkip: false,
                      maxRotation: horizontal ? 0 : 45,
                      minRotation: horizontal ? 0 : 45,
                      color: "#333",
                    },
                  },
                  y: {
                    display: true,
                    beginAtZero: true,
                    grid: {
                      color: "rgba(0, 0, 0, 0.05)",
                      drawBorder: false,
                    },
                    ticks: {
                      font: { size: 10 },
                      precision: 0,
                      color: "#333",
                    },
                  },
                },
          },
        };

        if (horizontal) {
          config.options.indexAxis = "y";
          config.options.scales.x.beginAtZero = true;
          config.options.scales.y.ticks.autoSkip = false;
        }

        charts[canvasId] = new Chart(ctx, config);
      }
    </script>
  </body>
</html>
